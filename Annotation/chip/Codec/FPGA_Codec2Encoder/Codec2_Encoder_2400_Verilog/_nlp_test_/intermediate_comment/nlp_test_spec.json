{
    "spec": "Module name: nlp_test. Module specification: The nlp_test module implements a Non-Linear Pitch (NLP) estimation algorithm for speech processing. It performs notch filtering, FIR filtering, FFT computation, and post-processing to estimate the pitch of an input signal. The module has input ports for initiating the algorithm (startnlp), clock (clk), reset (rst), initial memory values (nlp_mem_x, nlp_mem_y), and previous fundamental frequency (prev_f0). Output ports include the best estimated fundamental frequency (best_f0), previous fundamental frequency (out_prev_f0), completion indicator (donenlp), estimated pitch (pitch), and updated memory values (nlp_mem_x_out, nlp_mem_y_out). Internally, it uses various signals for state management, memory addressing, arithmetic operations, and control flags. The module is structure",
    "gpt-message": [
        {
            "role": "system",
            "content": "You are an expert in hardware design with a deep understanding of Verilog RTL codes. Now I want to train a large language model for code comment generation tasks specifically focused on Verilog RTL codes. And I want you to help me process the raw data, transforming it into suitable formats that can serve as inputs and outputs for the model."
        },
        {
            "role": "user",
            "content": "Name of the module and its functionality is as follows: \nModule name: nlp_test\n\nExplanation: This module appears to implement a Non-Linear Pitch (NLP) estimation algorithm for speech processing. It performs several operations including notch filtering, FIR filtering, FFT computation, and post-processing to estimate the pitch of an input signal. The module goes through multiple stages of processing, including data initialization, filtering, FFT calculation, and pitch estimation. It uses various memory blocks and arithmetic operations to process the input data and ultimately output a pitch value along with other related parameters."
        },
        {
            "role": "user",
            "content": "Input and output ports and their explanation is as follows: \nInput ports:\nstartnlp, clk, rst, nlp_mem_x, nlp_mem_y, prev_f0\n\nExplanation:\n- startnlp: Initiates the NLP algorithm\n- clk: Clock signal for synchronous operations\n- rst: Reset signal\n- nlp_mem_x, nlp_mem_y: Initial memory values for notch filter\n- prev_f0: Previous fundamental frequency estimate\n\nOutput ports:\nbest_f0, out_prev_f0, donenlp, pitch, nlp_mem_x_out, nlp_mem_y_out\n\nExplanation:\n- best_f0: Best estimated fundamental frequency\n- out_prev_f0: Output of the previous fundamental frequency\n- donenlp: Indicates completion of NLP algorithm\n- pitch: Estimated pitch value\n- nlp_mem_x_out, nlp_mem_y_out: Updated memory values for notch filter"
        },
        {
            "role": "user",
            "content": "Internal signals and their explanation is as follows: \nInternal signals:\nSTATE, NEXT_STATE, i, j, addr_nlp_sq, addr_mem_fir, addr_sn, in_sq, in_mem_fir, out_sq, out_mem_fir, read_sq, write_sq, read_fir, write_fir, notch, mem_x, mem_y, mem_fir_j_1, startdiv, div_in, div_ans, out_sn, donediv, m1_in1, m1_in2, m1_out, a1_in1, a1_in2, a1_out, m2_in1, m2_in2, m2_out, a2_in1, a2_in2, a2_out, addr_in_imag, addr_in_real, addr_out_real, addr_out_imag, write_fft_real, write_fft_imag, startfft, donefft, gmax, gmax_bin, startppsm, out_fw_real, pp_gmax, pp_prev_f0, doneppsm, out_sq_i_n.\n\nExplanation:\n- STATE, NEXT_STATE: Represent the current and next states of the FSM controlling the module's operation.\n- i, j: Loop counters used in various operations.\n- addr_nlp_sq, addr_mem_fir, addr_sn: Address signals for different memory blocks.\n- in_sq, in_mem_fir: Input data for square and FIR memory blocks.\n- out_sq, out_mem_fir, out_sn: Output data from square, FIR, and sn memory blocks.\n- read_sq, write_sq, read_fir, write_fir: Control signals for reading/writing to memory blocks.\n- notch, mem_x, mem_y: Signals used in notch filtering.\n- mem_fir_j_1: Temporary storage for FIR filter operation.\n- startdiv, div_in, div_ans, donediv: Signals for division operation.\n- m1_in1, m1_in2, m1_out, a1_in1, a1_in2, a1_out, m2_in1, m2_in2, m2_out, a2_in1, a2_in2, a2_out: Signals for multiplication and addition operations.\n- addr_in_imag, addr_in_real, addr_out_real, addr_out_imag: Address signals for FFT input/output.\n- write_fft_real, write_fft_imag: Data to be written to FFT memory.\n- startfft, donefft: Control signals for FFT operation.\n- gmax, gmax_bin: Maximum value and its bin in FFT output.\n- startppsm, doneppsm: Control signals for post-processing sub-multiples.\n- out_fw_real, pp_gmax, pp_prev_f0: Signals used in post-processing.\n- out_sq_i_n: Temporary storage for square operation."
        },
        {
            "role": "user",
            "content": "Original Verilog code is as follows: \n```verilog\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmodule nlp_test (startnlp,clk,rst,nlp_mem_x,nlp_mem_y,prev_f0,best_f0,out_prev_f0,pitch,nlp_mem_x_out,nlp_mem_y_out,donenlp);\n\n\n\n\n\n\t\t\tparameter N = 32;\n\t\t\tparameter Q = 16;\n\n\t\t\tinput clk,rst,startnlp;\n\t\t\tinput [N-1:0] nlp_mem_x,nlp_mem_y;\n\t\t\t\n\t\t\t\n\t\t\tinput [N-1:0] prev_f0;\n\t\t\toutput reg [N-1:0] best_f0,out_prev_f0;\n\n\t\t\toutput reg donenlp;\n\t\t\toutput reg [N-1:0] pitch;\n\t\t\toutput reg [N-1:0] nlp_mem_x_out,nlp_mem_y_out;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\n\t\t\t\n\n\n\n\n\nparameter START = 8'd0,\n          INIT_FOR_1 = 8'd1,\n          CHECK_I = 8'd2,\n          READ_SN = 8'd3,\n          SET_DELAY_1 = 8'd4,\n          SET_DELAY_2 = 8'd5,\n          CALC_SN_SQ = 8'd6,\n          SET_NLP_SQ = 8'd7,\n          INCR_I = 8'd8,\n\t\t\t INIT_FOR_2 = 8'd9,\n          CHECK_I_2 = 8'd10,\n          SET_ADDR_SQ_2 = 8'd11,\n          SET_DELAY_3 = 8'd12,\n          SET_DELAY_4 = 8'd13,\n          NOTCH_1 = 8'd14,\n          NOTCH_2 = 8'd15,\n          SET_MEM_X = 8'd16,\n          SET_MEM_Y = 8'd17,\n          SET_NEW_SQ_1 = 8'd18,\n          SET_NEW_SQ_2 = 8'd19,\n          INCR_I_2 = 8'd20,\n\t\t    INIT_FOR_3 = 8'd21,\n          CHECK_I_3 = 8'd22,\n          INNER_FOR_1 = 8'd23,\n          CHECK_J = 8'd24,\n          SET_ADDR_FIR = 8'd25,\n          SET_DELAY_5 = 8'd26,\n          SET_DELAY_6 = 8'd27,\n          GET_FIR_1 = 8'd28,\n          ADDR_WRITE_FIR = 8'd29,\n          GET_FIR_2 = 8'd30,\n          INCR_J = 8'd31,\n          ADDR_LAST_FIR = 8'd32,\n          SET_DELAY_7 = 8'd33,\n          SET_DELAY_8 = 8'd34,\n          SET_LAST_FIR = 8'd35,\n          INNER_FOR_2 = 8'd36,\n          CHECK_J_2 = 8'd37,\n          READ_FIR1 = 8'd38,\n          SET_DELAY_9 = 8'd39,\n          SET_DELAY_10 = 8'd40,\n          MULT_NLP_FIR = 8'd41,\n          ADDR_FIR_SQ = 8'd42,\n          SET_SQ_FIR = 8'd43,\n          INCR_J_2 = 8'd44,\n          INCR_I3 = 8'd45,\n          DONE = 8'd46,\n\t\t    SET_SQ_0 = 8'd47,\n\t\t    SET_DELAY_11 = 8'd48,\n\t\t    SET_DELAY_12 = 8'd49,\n\t\t    FFT_INIT = 8'd50,\n          FFT_ADDR = 8'd51,\n          DELAY_FFT_1 = 8'd52,\n          DELAY_FFT_2 = 8'd53,\n          WRITE_FFT_INIT = 8'd54,\n          INCR_I4 = 8'd55,\n          CHECK_I4 = 8'd56,\n          INIT_FOR_4 = 8'd57,\n          CHECK_I5 = 8'd58,\n          CALC_FFT_ADDR = 8'd59,\n          FOR_DELAY_1 = 8'd60,\n          FOR_DELAY_2 = 8'd61,\n          CALC_FFT_SQ_W = 8'd62,\n          WRITE_FFT_REAL = 8'd63,\n          INCR_I_5 = 8'd64,\n\t\t    START_DFT = 8'd65,\n\t\t    RUN_DFT = 8'd66,\n\t\t    INIT_FOR_5 = 8'd67,\n          CHECK_I_6 = 8'd68,\n          SET_ADDR_FOR_5 = 8'd69,\n          FOR_5_DELAY1 = 8'd70,\n          FOR_5_DELAY2 = 8'd71,\n          MULT_REAL_IMAGE_SQ = 8'd72,\n          ADD_REAL_IMAG_SQ = 8'd73,\n          SET_FW_REAL_ADD = 8'd74,\n          INCR_I6 = 8'd75,\n\t\t    RUN_DFT_2 = 8'd76,\n\t\t\t SET_GMAX_GMAX_BIN = 8'd77,\n\t\t\t INIT_FOR_GMAX = 8'd78,\n\t\t\t CHECK_I_GMAX = 8'd79,\n\t\t\t SET_ADDR_FW_GMAX = 8'd80,\n\t\t\t SET_DELAY_GMAX1 = 8'd81,\n\t\t\t SET_DELAY_GMAX2 = 8'd82,\n\t\t\t SET_IF_GMAX = 8'd83,\n\t\t\t INCR_I_GMAX = 8'd84,\n\t\t\t START_PPSM = 8'd85,\n\t\t\t GET_BESTF0 = 8'd86,\n\t\t\t INIT_FOR_SQ = 8'd87,\n\t\t\t CHECK_FOR_SQ = 8'd88,\n\t\t\t SET_ADDR_FOR_SQ = 8'd89,\n\t\t\t FOR_SQ_DELAY1 = 8'd90,\n\t\t\t FOR_SQ_DELAY2 = 8'd91,\n\t\t\t GET_SQ_I_N = 8'd92,\n\t\t\t SET_SQ_I_N = 8'd93,\n\t\t\t INCR_SQ_I = 8'd94,\n\t\t\t START_DIV_BEST0 = 8'd95,\n\t\t\t CALC_DIV_BESTF0 = 8'd96,\n\t\t\t SET_PITCH = 8'd97;\n\t\t  \n\nreg [7:0] STATE, NEXT_STATE;\n\nparameter [9:0] M = 10'd320,\n\t\t\t\tN_SAMP = 10'd80,\n\t\t\t\tDEC = 10'd5;\n\t\t\t\t\nparameter [N-1:0] COEFF \t= 32'b00000000000000001111001100110011,\n\t\t\t\t\t\tONE   \t= 32'b00000000000000010000000000000000,\n\t\t\t\t\t\tNLP_FS \t= {16'd8000,16'd0};\n\t\t\t\t  \nparameter [N-1:0] \tnlp_fir0  = 32'b10000000000000000000000001000110,\n\t\t\t\t\tnlp_fir1  = 32'b10000000000000000000000001001000,\n\t\t\t\t\tnlp_fir2  = 32'b10000000000000000000000000111100,\n\t\t\t\t\tnlp_fir3  = 32'b10000000000000000000000000011011,\n\t\t\t\t\tnlp_fir4  = 32'b00000000000000000000000000100100,\n\t\t\t\t\tnlp_fir5  = 32'b00000000000000000000000010000011,\n\t\t\t\t\tnlp_fir6  = 32'b00000000000000000000000011110010,\n\t\t\t\t\tnlp_fir7  = 32'b00000000000000000000000101010001,\n\t\t\t\t\tnlp_fir8  = 32'b00000000000000000000000101101110,\n\t\t\t\t\tnlp_fir9  = 32'b00000000000000000000000100011010,\n\t\t\t\t\tnlp_fir10  = 32'b00000000000000000000000000110100,\n\t\t\t\t\tnlp_fir11  = 32'b10000000000000000000000100111011,\n\t\t\t\t\tnlp_fir12  = 32'b10000000000000000000001011111111,\n\t\t\t\t\tnlp_fir13  = 32'b10000000000000000000010010101000,\n\t\t\t\t\tnlp_fir14  = 32'b10000000000000000000010110100110,\n\t\t\t\t\tnlp_fir15  = 32'b10000000000000000000010101011011,\n\t\t\t\t\tnlp_fir16  = 32'b10000000000000000000001101000111,\n\t\t\t\t\tnlp_fir17  = 32'b00000000000000000000000011010011,\n\t\t\t\t\tnlp_fir18  = 32'b00000000000000000000011011010100,\n\t\t\t\t\tnlp_fir19  = 32'b00000000000000000000111000110110,\n\t\t\t\t\tnlp_fir20  = 32'b00000000000000000001011000011000,\n\t\t\t\t\tnlp_fir21  = 32'b00000000000000000001110101100011,\n\t\t\t\t\tnlp_fir22  = 32'b00000000000000000010001100000001,\n\t\t\t\t\tnlp_fir23  = 32'b00000000000000000010011000001111,\n\t\t\t\t\tnlp_fir24  = 32'b00000000000000000010011000001111,\n\t\t\t\t\tnlp_fir25  = 32'b00000000000000000010001100000001,\n\t\t\t\t\tnlp_fir26  = 32'b00000000000000000001110101100011,\n\t\t\t\t\tnlp_fir27  = 32'b00000000000000000001011000011000,\n\t\t\t\t\tnlp_fir28  = 32'b00000000000000000000111000110110,\n\t\t\t\t\tnlp_fir29  = 32'b00000000000000000000011011010100,\n\t\t\t\t\tnlp_fir30  = 32'b00000000000000000000000011010011,\n\t\t\t\t\tnlp_fir31  = 32'b10000000000000000000001101000111,\n\t\t\t\t\tnlp_fir32  = 32'b10000000000000000000010101011011,\n\t\t\t\t\tnlp_fir33  = 32'b10000000000000000000010110100110,\n\t\t\t\t\tnlp_fir34  = 32'b10000000000000000000010010101000,\n\t\t\t\t\tnlp_fir35  = 32'b10000000000000000000001011111111,\n\t\t\t\t\tnlp_fir36  = 32'b10000000000000000000000100111011,\n\t\t\t\t\tnlp_fir37  = 32'b00000000000000000000000000110100,\n\t\t\t\t\tnlp_fir38  = 32'b00000000000000000000000100011010,\n\t\t\t\t\tnlp_fir39  = 32'b00000000000000000000000101101110,\n\t\t\t\t\tnlp_fir40  = 32'b00000000000000000000000101010001,\n\t\t\t\t\tnlp_fir41  = 32'b00000000000000000000000011110010,\n\t\t\t\t\tnlp_fir42  = 32'b00000000000000000000000010000011,\n\t\t\t\t\tnlp_fir43  = 32'b00000000000000000000000000100100,\n\t\t\t\t\tnlp_fir44  = 32'b10000000000000000000000000011011,\n\t\t\t\t\tnlp_fir45  = 32'b10000000000000000000000000111100,\n\t\t\t\t\tnlp_fir46  = 32'b10000000000000000000000001001000,\n\t\t\t\t\tnlp_fir47  = 32'b10000000000000000000000001000110;\n\t\t\t\t\t\nparameter [N-1:0] \tnlp_w0  = 32'b00000000000000000000000000000000,\n\t\t\t\t\tnlp_w1  = 32'b00000000000000000000000010100010,\n\t\t\t\t\tnlp_w2  = 32'b00000000000000000000001010001001,\n\t\t\t\t\tnlp_w3  = 32'b00000000000000000000010110101111,\n\t\t\t\t\tnlp_w4  = 32'b00000000000000000000101000001101,\n\t\t\t\t\tnlp_w5  = 32'b00000000000000000000111110010110,\n\t\t\t\t\tnlp_w6  = 32'b00000000000000000001011000111101,\n\t\t\t\t\tnlp_w7  = 32'b00000000000000000001110111110010,\n\t\t\t\t\tnlp_w8  = 32'b00000000000000000010011010100000,\n\t\t\t\t\tnlp_w9  = 32'b00000000000000000011000000110001,\n\t\t\t\t\tnlp_w10  = 32'b00000000000000000011101010001101,\n\t\t\t\t\tnlp_w11  = 32'b00000000000000000100010110011010,\n\t\t\t\t\tnlp_w12  = 32'b00000000000000000101000100111100,\n\t\t\t\t\tnlp_w13  = 32'b00000000000000000101110101010101,\n\t\t\t\t\tnlp_w14  = 32'b00000000000000000110100111000101,\n\t\t\t\t\tnlp_w15  = 32'b00000000000000000111011001101111,\n\t\t\t\t\tnlp_w16  = 32'b00000000000000001000001100110000,\n\t\t\t\t\tnlp_w17  = 32'b00000000000000001000111111101010,\n\t\t\t\t\tnlp_w18  = 32'b00000000000000001001110001111011,\n\t\t\t\t\tnlp_w19  = 32'b00000000000000001010100011000100,\n\t\t\t\t\tnlp_w20  = 32'b00000000000000001011010010100101,\n\t\t\t\t\tnlp_w21  = 32'b00000000000000001100000000000000,\n\t\t\t\t\tnlp_w22  = 32'b00000000000000001100101010111000,\n\t\t\t\t\tnlp_w23  = 32'b00000000000000001101010010110010,\n\t\t\t\t\tnlp_w24  = 32'b00000000000000001101110111010100,\n\t\t\t\t\tnlp_w25  = 32'b00000000000000001110011000001000,\n\t\t\t\t\tnlp_w26  = 32'b00000000000000001110110100111000,\n\t\t\t\t\tnlp_w27  = 32'b00000000000000001111001101010010,\n\t\t\t\t\tnlp_w28  = 32'b00000000000000001111100001000111,\n\t\t\t\t\tnlp_w29  = 32'b00000000000000001111110000001010,\n\t\t\t\t\tnlp_w30  = 32'b00000000000000001111111010010001,\n\t\t\t\t\tnlp_w31  = 32'b00000000000000001111111111010111,\n\t\t\t\t\tnlp_w32  = 32'b00000000000000001111111111010111,\n\t\t\t\t\tnlp_w33  = 32'b00000000000000001111111010010001,\n\t\t\t\t\tnlp_w34  = 32'b00000000000000001111110000001010,\n\t\t\t\t\tnlp_w35  = 32'b00000000000000001111100001000111,\n\t\t\t\t\tnlp_w36  = 32'b00000000000000001111001101010010,\n\t\t\t\t\tnlp_w37  = 32'b00000000000000001110110100111000,\n\t\t\t\t\tnlp_w38  = 32'b00000000000000001110011000001000,\n\t\t\t\t\tnlp_w39  = 32'b00000000000000001101110111010100,\n\t\t\t\t\tnlp_w40  = 32'b00000000000000001101010010110010,\n\t\t\t\t\tnlp_w41  = 32'b00000000000000001100101010111000,\n\t\t\t\t\tnlp_w42  = 32'b00000000000000001100000000000000,\n\t\t\t\t\tnlp_w43  = 32'b00000000000000001011010010100101,\n\t\t\t\t\tnlp_w44  = 32'b00000000000000001010100011000100,\n\t\t\t\t\tnlp_w45  = 32'b00000000000000001001110001111011,\n\t\t\t\t\tnlp_w46  = 32'b00000000000000001000111111101010,\n\t\t\t\t\tnlp_w47  = 32'b00000000000000001000001100110000,\n\t\t\t\t\tnlp_w48  = 32'b00000000000000000111011001101111,\n\t\t\t\t\tnlp_w49  = 32'b00000000000000000110100111000101,\n\t\t\t\t\tnlp_w50  = 32'b00000000000000000101110101010101,\n\t\t\t\t\tnlp_w51  = 32'b00000000000000000101000100111100,\n\t\t\t\t\tnlp_w52  = 32'b00000000000000000100010110011010,\n\t\t\t\t\tnlp_w53  = 32'b00000000000000000011101010001101,\n\t\t\t\t\tnlp_w54  = 32'b00000000000000000011000000110001,\n\t\t\t\t\tnlp_w55  = 32'b00000000000000000010011010100000,\n\t\t\t\t\tnlp_w56  = 32'b00000000000000000001110111110010,\n\t\t\t\t\tnlp_w57  = 32'b00000000000000000001011000111101,\n\t\t\t\t\tnlp_w58  = 32'b00000000000000000000111110010110,\n\t\t\t\t\tnlp_w59  = 32'b00000000000000000000101000001101,\n\t\t\t\t\tnlp_w60  = 32'b00000000000000000000010110101111,\n\t\t\t\t\tnlp_w61  = 32'b00000000000000000000001010001001,\n\t\t\t\t\tnlp_w62  = 32'b00000000000000000000000010100010,\n\t\t\t\t\tnlp_w63  = 32'b00000000000000000000000000000000;\n\n\n\n\n\nreg [9:0] i,j;\nreg \t\t\t[N-1:0] \t\tm1_in1,m1_in2,a1_in1,a1_in2,m2_in1,m2_in2,a2_in1,a2_in2;\nwire \t\t\t[N-1:0] \t\tm1_out,a1_out,m2_out,a2_out;\n\nreg [9:0] addr_nlp_sq,addr_mem_fir,addr_sn;\nreg [N-1:0] in_sq,in_mem_fir;\nwire [N-1:0] out_sq,out_mem_fir;\n\nreg [N-1:0] m1,m2,m3,m4,a1,a2;\n\nreg read_sq,write_sq,read_fir,write_fir;\n\nreg [N-1:0] notch,mem_x,mem_y;\n\nreg [N-1:0] mem_fir_j_1;\nreg startdiv;\nreg [N-1:0] div_in;\nwire [N-1:0] div_ans,out_sn;\nwire donediv;\n\nqmult  \t\t\t#(Q,N) \t\t\tqmult1\t   (m1_in1,m1_in2,m1_out);\nqadd   \t\t\t#(Q,N)\t\t\tadder1     (a1_in1,a1_in2,a1_out);\n\nqmult  \t\t\t#(Q,N) \t\t\tqmult2\t   (m2_in1,m2_in2,m2_out);\nqadd   \t\t\t#(Q,N)\t\t\tadder2     (a2_in1,a2_in2,a2_out);\n\nfpdiv_clk  \t  \t \t\t\t\tdivider\t   (startdiv,clk,rst,div_in,div_ans,donediv);\n\n\nRAM_nlp_c2_sn    in_sn\t   (addr_sn,clk,,1,0,out_sn);\nRAM_nlp_sq       nlp_sq\t       (addr_nlp_sq,clk,in_sq,read_sq,write_sq,out_sq);\nRAM_nlp_mem_fir  mem_fir   (addr_mem_fir,clk,in_mem_fir,read_fir,write_fir,out_mem_fir);\n\n\nreg [9:0] \t\taddr_in_imag,addr_in_real,addr_out_real,addr_out_imag;\nwire   [N-1:0]\t\tin_imag_data,in_real_data;\n\t\t\nwire [9:0] fft_addr_in_imag,fft_addr_in_real,fft_addr_out_real,fft_addr_out_imag;\n reg [N-1:0] write_fft_real;\n reg [N-1:0] write_fft_imag; \n\nreg [9:0] addr_out_real_gmax,gmax_bin;\nreg [N-1:0] write_fft_real_gmax;\n reg [N-1:0] gmax;\n\n\n\nwire [N-1:0] out_fft_real, out_fft_imag,fft_write_fft_real,fft_write_fft_imag,out_fft_real_gmax;\n\nreg read_in_fftr,read_in_ffti,write_in_fftr,write_in_ffti,re_out_fftr_gmax,we_out_fftr_gmax,\n\t\t\tre_fftr,re_ffti,we_fftr,we_ffti,re_out_fftr,re_out_ffti,we_out_fftr,we_out_ffti,startfft;\nreg [N-1:0] write_in_fft_real,write_in_fft_imag;\nwire donefft,doneppsm;\n\nRAM_in_fft_real            in_real\t   (addr_in_real,clk,write_in_fft_real,re_fftr,we_fftr,in_real_data);\nRAM_in_fft_imag      \t\tin_imag\t   (addr_in_imag,clk,write_in_fft_imag,re_ffti,we_ffti,in_imag_data);\n\nRAM_out_fft_real         fft_out_real\t   (addr_out_real,clk,write_fft_real,re_out_fftr,we_out_fftr,out_fft_real);\nRAM_out_fft_imag      \t fft_out_imag\t   (addr_out_imag,clk,write_fft_imag,re_out_ffti,we_out_ffti,out_fft_imag);\n\nRAM_out_fft_real_gmax    fft_out_real_gmax\t   (addr_out_real_gmax,clk,write_fft_real_gmax,re_out_fftr_gmax,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twe_out_fftr_gmax,out_fft_real_gmax);\n\n\nfft_nlp fft_nlp_module (startfft,clk,rst,in_imag_data,in_real_data,\n\t\t\t\t\tfft_addr_in_imag,fft_addr_in_real,fft_addr_out_real,fft_addr_out_imag,\n\t\t\t\t\t\t\t\tfft_write_fft_real,fft_write_fft_imag,donefft);\n\t\t\t\t\t\t\t\t\npost_process_sub_multiples ppsm (startppsm,clk,rst,out_fw_real,\n\t\t\t\t\t\t\tpp_gmax,pp_gmax_bin,pp_prev_f0,pp_best_f0,addr_fw_real,doneppsm);\n\t\t\t\t\t\t\t\nreg startppsm;\nreg [N-1:0] out_fw_real,pp_gmax;\nreg [9:0] pp_gmax_bin;\nreg [N-1:0] pp_prev_f0;\nwire [N-1:0] pp_best_f0;\nwire [9:0] addr_fw_real;\nreg [N-1:0] out_sq_i_n;\n\n\n\n\n\n\nalways@(posedge clk or negedge rst)     \nbegin\n\n\tif (rst == 1'b0)\n\t\tSTATE <= START;\n\telse\n\t\tSTATE <= NEXT_STATE;\n\nend\n\n\nalways@(*)                              \nbegin\n\tcase(STATE)\n\n\tSTART:\n\tbegin\n\t\tif(startnlp == 1'b1)\n\t\tbegin\n\t\t\tNEXT_STATE = INIT_FOR_1;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = START;\n\t\tend\n\tend\n\n\tINIT_FOR_1:\n\tbegin\n\t\tNEXT_STATE = CHECK_I;\n\tend\n\n\tCHECK_I:\n\tbegin\n\t\tif(i < M)\n\t\tbegin\n\t\t\tNEXT_STATE = READ_SN;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = INIT_FOR_2;\n\t\tend\n\tend\n\n\tREAD_SN:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_1;\n\tend\n\n\tSET_DELAY_1:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_2;\n\tend\n\n\tSET_DELAY_2:\n\tbegin\n\t\tNEXT_STATE = CALC_SN_SQ;\n\tend\n\n\tCALC_SN_SQ:\n\tbegin\n\t\tNEXT_STATE = SET_NLP_SQ;\n\tend\n\n\tSET_NLP_SQ:\n\tbegin\n\t\tNEXT_STATE = INCR_I;\n\tend\n\n\tINCR_I:\n\tbegin\n\t\tNEXT_STATE = CHECK_I;\n\tend\n\t\n\tINIT_FOR_2:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_2;\n\tend\n\n\tCHECK_I_2:\n\tbegin\n\t\tif(i < M)\n\t\tbegin\n\t\t\tNEXT_STATE = SET_ADDR_SQ_2;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = INIT_FOR_3;\n\t\tend\n\tend\n\n\tSET_ADDR_SQ_2:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_3;\n\tend\n\n\tSET_DELAY_3:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_4;\n\tend\n\n\tSET_DELAY_4:\n\tbegin\n\t\tNEXT_STATE = NOTCH_1;\n\tend\n\n\tNOTCH_1:\n\tbegin\n\t\tNEXT_STATE = NOTCH_2;\n\tend\n\n\tNOTCH_2:\n\tbegin\n\t\tNEXT_STATE = SET_MEM_X;\n\tend\n\n\tSET_MEM_X:\n\tbegin\n\t\tNEXT_STATE = SET_MEM_Y;\n\tend\n\n\tSET_MEM_Y:\n\tbegin\n\t\tNEXT_STATE = SET_NEW_SQ_1;\n\tend\n\n\tSET_NEW_SQ_1:\n\tbegin\n\t\tNEXT_STATE = SET_NEW_SQ_2;\n\tend\n\n\tSET_NEW_SQ_2:\n\tbegin\n\t\tNEXT_STATE = INCR_I_2;\n\tend\n\n\tINCR_I_2:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_2;\n\tend\n\t\n\tINIT_FOR_3:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_3;\n\tend\n\n\tCHECK_I_3:\n\tbegin\n\t\tif(i < M)\n\t\tbegin\n\t\t\tNEXT_STATE = INNER_FOR_1;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = FFT_INIT;\n\t\tend\n\tend\n\n\tINNER_FOR_1:\n\tbegin\n\t\tNEXT_STATE = CHECK_J;\n\tend\n\n\tCHECK_J:\n\tbegin\n\t\tif(j < 10'd47)\n\t\tbegin\n\t\t\tNEXT_STATE = SET_ADDR_FIR;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = ADDR_LAST_FIR;\n\t\tend\n\tend\n\n\tSET_ADDR_FIR:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_5;\n\tend\n\n\tSET_DELAY_5:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_6;\n\tend\n\n\tSET_DELAY_6:\n\tbegin\n\t\tNEXT_STATE = GET_FIR_1;\n\tend\n\n\tGET_FIR_1:\n\tbegin\n\t\tNEXT_STATE = ADDR_WRITE_FIR;\n\tend\n\n\tADDR_WRITE_FIR:\n\tbegin\n\t\tNEXT_STATE = GET_FIR_2;\n\tend\n\n\tGET_FIR_2:\n\tbegin\n\t\tNEXT_STATE = INCR_J;\n\tend\n\n\tINCR_J:\n\tbegin\n\t\tNEXT_STATE = CHECK_J;\n\tend\n\n\tADDR_LAST_FIR:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_7;\n\tend\n\n\tSET_DELAY_7:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_8;\n\tend\n\n\tSET_DELAY_8:\n\tbegin\n\t\tNEXT_STATE = SET_LAST_FIR;\n\tend\n\n\tSET_LAST_FIR:\n\tbegin\n\t\tNEXT_STATE = SET_SQ_0;\n\tend\n\t\n\tSET_SQ_0:\n\tbegin\n\t\tNEXT_STATE = INNER_FOR_2;\n\tend\n\n\tINNER_FOR_2:\n\tbegin\n\t\tNEXT_STATE = CHECK_J_2;\n\tend\n\n\tCHECK_J_2:\n\tbegin\n\t\tif(j < 10'd48)\n\t\tbegin\n\t\t\tNEXT_STATE = READ_FIR1;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = INCR_I3;\n\t\tend\n\tend\n\n\tREAD_FIR1:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_9;\n\tend\n\n\tSET_DELAY_9:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_10;\n\tend\n\n\tSET_DELAY_10:\n\tbegin\n\t\tNEXT_STATE = MULT_NLP_FIR;\n\tend\n\n\tMULT_NLP_FIR:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_11;\n\tend\n\t\n\tSET_DELAY_11:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_12;\n\tend\n\t\t\n\tSET_DELAY_12:\n\tbegin\n\t\tNEXT_STATE = ADDR_FIR_SQ;\n\tend\n\n\tADDR_FIR_SQ:\n\tbegin\n\t\tNEXT_STATE = SET_SQ_FIR;\n\tend\n\n\tSET_SQ_FIR:\n\tbegin\n\t\tNEXT_STATE = INCR_J_2;\n\tend\n\n\tINCR_J_2:\n\tbegin\n\t\tNEXT_STATE = CHECK_J_2;\n\tend\n\n\tINCR_I3:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_3;\n\tend\n\t\n\tFFT_INIT:\n\tbegin\n\t\tNEXT_STATE = FFT_ADDR;\n\tend\n\n\tFFT_ADDR:\n\tbegin\n\t\tNEXT_STATE = DELAY_FFT_1;\n\tend\n\n\tDELAY_FFT_1:\n\tbegin\n\t\tNEXT_STATE = DELAY_FFT_2;\n\tend\n\n\tDELAY_FFT_2:\n\tbegin\n\t\tNEXT_STATE = WRITE_FFT_INIT;\n\tend\n\n\tWRITE_FFT_INIT:\n\tbegin\n\t\tNEXT_STATE = INCR_I4;\n\tend\n\n\tINCR_I4:\n\tbegin\n\t\tNEXT_STATE = CHECK_I4;\n\tend\n\n\tCHECK_I4:\n\tbegin\n\t\tif(i < 10'd512)\n\t\tbegin\n\t\t\tNEXT_STATE = FFT_ADDR;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = INIT_FOR_4;\n\t\tend\n\t\t\n\tend\n\n\tINIT_FOR_4:\n\tbegin\n\t\tNEXT_STATE = CHECK_I5;\n\tend\n\n\tCHECK_I5:\n\tbegin\n\t\tif(i < 10'd64)\n\t\tbegin\n\t\t\tNEXT_STATE = CALC_FFT_ADDR;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = START_DFT;  \n\t\tend\n\t\t\n\tend\n\n\tCALC_FFT_ADDR:\n\tbegin\n\t\tNEXT_STATE = FOR_DELAY_1;\n\tend\n\n\tFOR_DELAY_1:\n\tbegin\n\t\tNEXT_STATE = FOR_DELAY_2;\n\tend\n\n\tFOR_DELAY_2:\n\tbegin\n\t\tNEXT_STATE = CALC_FFT_SQ_W;\n\tend\n\n\tCALC_FFT_SQ_W:\n\tbegin\n\t\tNEXT_STATE = WRITE_FFT_REAL;\n\tend\n\n\tWRITE_FFT_REAL:\n\tbegin\n\t\tNEXT_STATE = INCR_I_5;\n\tend\n\n\tINCR_I_5:\n\tbegin\n\t\tNEXT_STATE = CHECK_I5;\n\tend\n\t\n\tSTART_DFT:\n\tbegin\n\t\tNEXT_STATE = RUN_DFT;\n\tend\n\t\n\tRUN_DFT:\n\tbegin\n\t\tif(donefft)\n\t\tbegin\n\t\t\tNEXT_STATE = INIT_FOR_5;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = RUN_DFT;\n\t\tend\n\tend\n\t\n\t\n\t\n\t\n\t\n\t\n\tINIT_FOR_5:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_6;\n\tend\n\n\tCHECK_I_6:\n\tbegin\n\t\tif(i < 10'd512)\n\t\tbegin\n\t\t\tNEXT_STATE = SET_ADDR_FOR_5;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = SET_GMAX_GMAX_BIN;\n\t\tend\n\tend\n\n\tSET_ADDR_FOR_5:\n\tbegin\n\t\tNEXT_STATE = FOR_5_DELAY1;\n\tend\n\n\tFOR_5_DELAY1:\n\tbegin\n\t\tNEXT_STATE = FOR_5_DELAY2;\n\tend\n\n\tFOR_5_DELAY2:\n\tbegin\n\t\tNEXT_STATE = MULT_REAL_IMAGE_SQ;\n\tend\n\n\tMULT_REAL_IMAGE_SQ:\n\tbegin\n\t\tNEXT_STATE = ADD_REAL_IMAG_SQ;\n\tend\n\n\tADD_REAL_IMAG_SQ:\n\tbegin\n\t\tNEXT_STATE = SET_FW_REAL_ADD;\n\tend\n\n\tSET_FW_REAL_ADD:\n\tbegin\n\t\tNEXT_STATE = INCR_I6;\n\tend\n\n\tINCR_I6:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_6;\n\tend\n\t\n\tSET_GMAX_GMAX_BIN:\n\tbegin\n\t\tNEXT_STATE = INIT_FOR_GMAX;\n\tend\n\t\n\tINIT_FOR_GMAX:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_GMAX;\n\tend\n\t\n\tCHECK_I_GMAX:\n\tbegin\n\t\tif(i <= 10'd128)\n\t\tbegin\n\t\t\tNEXT_STATE = SET_ADDR_FW_GMAX;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = START_PPSM;\n\t\tend\n\tend\n\t\n\tSET_ADDR_FW_GMAX:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_GMAX1;\n\tend\n\t\n\tSET_DELAY_GMAX1:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_GMAX2;\n\tend\n\t\n\tSET_DELAY_GMAX2:\n\tbegin\n\t\tNEXT_STATE = SET_IF_GMAX;\n\tend\n\t\n\tSET_IF_GMAX:\n\tbegin\n\t\tNEXT_STATE = INCR_I_GMAX;\n\tend\n\t\n\tINCR_I_GMAX:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_GMAX;\n\tend\n\t\n\tSTART_PPSM:\n\tbegin\n\t\tif(doneppsm)\n\t\tbegin\n\t\t\tNEXT_STATE = GET_BESTF0;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = START_PPSM;\n\t\tend\n\tend\n\t\n\tGET_BESTF0:\n\tbegin\n\t\tNEXT_STATE = INIT_FOR_SQ;\n\tend\n\t\n\tINIT_FOR_SQ:\n\tbegin\n\t\tNEXT_STATE = CHECK_FOR_SQ;\n\tend\n\t\n\tCHECK_FOR_SQ:\n\tbegin\n\t\tif(i < 10'd240)\n\t\tbegin\n\t\t\tNEXT_STATE = SET_ADDR_FOR_SQ;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = START_DIV_BEST0;\n\t\tend\n\t\t\n\tend\n\t\n\tSET_ADDR_FOR_SQ:\n\tbegin\n\t\tNEXT_STATE = FOR_SQ_DELAY1;\n\tend\n\t\n\tFOR_SQ_DELAY1:\n\tbegin\n\t\tNEXT_STATE = FOR_SQ_DELAY2;\n\tend\n\t\n\tFOR_SQ_DELAY2:\n\tbegin\n\t\tNEXT_STATE = GET_SQ_I_N;\n\tend\n\t\n\tGET_SQ_I_N:\n\tbegin\n\t\tNEXT_STATE = SET_SQ_I_N;\n\tend\n\t\n\tSET_SQ_I_N:\n\tbegin\n\t\tNEXT_STATE = INCR_SQ_I;\n\tend\n\t\n\tINCR_SQ_I:\n\tbegin\n\t\tNEXT_STATE = CHECK_FOR_SQ;\n\tend\n\t\n\tSTART_DIV_BEST0:\n\tbegin\n\t\tNEXT_STATE = CALC_DIV_BESTF0;\n\tend\n\t\n\tCALC_DIV_BESTF0:\n\tbegin\n\t\tif(donediv)\n\t\tbegin\n\t\t\tNEXT_STATE = SET_PITCH;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = CALC_DIV_BESTF0;\n\t\tend\n\tend\n\t\n\tSET_PITCH:\n\tbegin\n\t\tNEXT_STATE = DONE;\n\tend\n\n\tDONE:\n\tbegin\n\t\tNEXT_STATE = START;\n\tend\n\n\tdefault:\n\tbegin\n\t\tNEXT_STATE = DONE;\n\tend\n\n\tendcase\nend\n\n\nalways@(posedge clk or negedge rst)     \nbegin\n\n\tif (rst == 1'b0)\n\tbegin\n\n\t\tdonenlp <= 1'b0;\n\n\tend\n\n\telse\n\tbegin\n\t\tcase(STATE)\n\n\t\tSTART:\n\t\tbegin\n\t\t\tdonenlp <= 1'b0;\n\t\tend\n\n\t\tINIT_FOR_1:\n\t\tbegin\n\t\t\ti <= M - N_SAMP;\n\t\t\twrite_sq <= 1'b1;\n\t\t\tread_sq <= 1'b0;\n\t\tend\n\n\t\tCHECK_I:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tREAD_SN:\n\t\tbegin\n\t\t\taddr_sn <= i;\n\t\tend\n\n\t\tSET_DELAY_1:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_DELAY_2:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tCALC_SN_SQ:\n\t\tbegin\n\t\t\tm1_in1 <= out_sn;\n\t\t\tm1_in2 <= out_sn;\n\t\t\taddr_nlp_sq <= i;\n\t\tend\n\n\t\tSET_NLP_SQ:\n\t\tbegin\n\t\t\tin_sq <= m1_out;\n\t\t\n\t\tend\n\n\t\tINCR_I:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\t\t\n\t\tINIT_FOR_2:\n\t\tbegin\n\t\t\ti <= M - N_SAMP;\n\t\t\tmem_x <= nlp_mem_x;\n\t\t\tmem_y <= nlp_mem_y;\n\t\tend\n\n\t\tCHECK_I_2:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_ADDR_SQ_2:\n\t\tbegin\n\t\t\taddr_nlp_sq <= i;\n\t\t\tread_sq <= 1'b1;\n\t\t\twrite_sq <= 1'b0;\n\t\tend\n\n\t\tSET_DELAY_3:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_DELAY_4:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tNOTCH_1:\n\t\tbegin\n\t\t\ta1_in1 <= out_sq;\n\t\t\ta1_in2 <= {(mem_x[N-1] == 0)?1'b1:1'b0,mem_x[N-2:0]};\n\t\tend\n\n\t\tNOTCH_2:\n\t\tbegin\n\t\t\tm1_in1 <= COEFF;\n\t\t\tm1_in2 <= mem_y;\n\t\t\tnotch <= a1_out;\n\t\t\n\t\tend\n\n\t\tSET_MEM_X:\n\t\tbegin\n\t\t\ta1_in1 <= notch;\n\t\t\ta1_in2 <= m1_out;\n\t\t\tmem_x <= out_sq;\n\t\t\twrite_sq <= 1'b1;\n\t\t\tread_sq <= 1'b0;\n\t\tend\n\n\t\tSET_MEM_Y:\n\t\tbegin\n\t\t\tmem_y <= a1_out;\n\t\t\tnotch <= a1_out;\n\t\t\n\t\tend\n\n\t\tSET_NEW_SQ_1:\n\t\tbegin\n\t\t\ta1_in1 <= notch;\n\t\t\ta1_in2 <= ONE;\n\t\tend\n\n\t\tSET_NEW_SQ_2:\n\t\tbegin\n\t\t\tin_sq <= a1_out;\n\t\t\t\n\t\tend\n\n\t\tINCR_I_2:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\t\t\n\t\tINIT_FOR_3:\n\t\tbegin\n\t\t\ti <= M - N_SAMP;\n\t\tend\n\n\t\tCHECK_I_3:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tINNER_FOR_1:\n\t\tbegin\n\t\t\tj <= 10'd0;\n\t\tend\n\n\t\tCHECK_J:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_ADDR_FIR:\n\t\tbegin\n\t\t\taddr_mem_fir <= j + 10'd1;\n\t\t\tread_fir <= 1'b1;\n\t\t\twrite_fir <= 1'b0;\n\t\tend\n\n\t\tSET_DELAY_5:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_DELAY_6:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tGET_FIR_1:\n\t\tbegin\n\t\t\tmem_fir_j_1 <= out_mem_fir;\n\t\tend\n\n\t\tADDR_WRITE_FIR:\n\t\tbegin\n\t\t\taddr_mem_fir <= j;\n\t\t\tread_fir <= 1'b0;\n\t\t\twrite_fir <= 1'b1;\n\t\tend\n\n\t\tGET_FIR_2:\n\t\tbegin\n\t\t\tin_mem_fir <= mem_fir_j_1;\n\t\tend\n\n\t\tINCR_J:\n\t\tbegin\n\t\t\tj <= j + 10'd1;\n\t\tend\n\n\t\tADDR_LAST_FIR:\n\t\tbegin\n\t\t\taddr_mem_fir <= 10'd47;\n\t\t\tread_fir <= 1'b0;\n\t\t\twrite_fir <= 1'b1;\n\t\t\taddr_nlp_sq <= i;\n\t\t\tread_sq <= 1'b1;\n\t\t\twrite_sq <= 1'b0;\n\t\tend\n\n\t\tSET_DELAY_7:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_DELAY_8:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_LAST_FIR:\n\t\tbegin\n\t\t\tin_mem_fir <= out_sq;\n\t\t\twrite_sq <= 1'b1;\n\t\t\tread_sq <= 1'b0;\n\t\tend\n\t\t\n\t\tSET_SQ_0:\n\t\tbegin\n\t\t\tin_sq <= 32'b0;\n\t\tend\n\n\t\tINNER_FOR_2:\n\t\tbegin\n\t\t\tj <= 10'd0;\n\t\tend\n\n\t\tCHECK_J_2:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tREAD_FIR1:\n\t\tbegin\n\t\t\taddr_mem_fir <= j;\n\t\t\tread_fir <= 1'b1;\n\t\t\twrite_fir <= 1'b0;\n\t\tend\n\n\t\tSET_DELAY_9:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_DELAY_10:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tMULT_NLP_FIR:\n\t\tbegin\n\t\t\tcase (j)\n\t\t\t10'd0  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir0;\n\t\t\t   end\n\t\t\t10'd1  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir1;\n\t\t\t   end\n\t\t\t10'd2  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir2;\n\t\t\t   end\n\t\t\t10'd3  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir3;\n\t\t\t   end\n\t\t\t10'd4  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir4;\n\t\t\t   end\n\t\t\t10'd5  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir5;\n\t\t\t   end\n\t\t\t10'd6  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir6;\n\t\t\t   end\n\t\t\t10'd7  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir7;\n\t\t\t   end\n\t\t\t10'd8  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir8;\n\t\t\t   end\n\t\t\t10'd9  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir9;\n\t\t\t   end\n\t\t\t10'd10  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir10;\n\t\t\t   end\n\t\t\t10'd11  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir11;\n\t\t\t   end\n\t\t\t10'd12  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir12;\n\t\t\t   end\n\t\t\t10'd13  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir13;\n\t\t\t   end\n\t\t\t10'd14  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir14;\n\t\t\t   end\n\t\t\t10'd15  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir15;\n\t\t\t   end\n\t\t\t10'd16  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir16;\n\t\t\t   end\n\t\t\t10'd17  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir17;\n\t\t\t   end\n\t\t\t10'd18  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir18;\n\t\t\t   end\n\t\t\t10'd19  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir19;\n\t\t\t   end\n\t\t\t10'd20  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir20;\n\t\t\t   end\n\t\t\t10'd21  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir21;\n\t\t\t   end\n\t\t\t10'd22  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir22;\n\t\t\t   end\n\t\t\t10'd23  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir23;\n\t\t\t   end\n\t\t\t10'd24  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir24;\n\t\t\t   end\n\t\t\t10'd25  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir25;\n\t\t\t   end\n\t\t\t10'd26  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir26;\n\t\t\t   end\n\t\t\t10'd27  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir27;\n\t\t\t   end\n\t\t\t10'd28  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir28;\n\t\t\t   end\n\t\t\t10'd29  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir29;\n\t\t\t   end\n\t\t\t10'd30  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir30;\n\t\t\t   end\n\t\t\t10'd31  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir31;\n\t\t\t   end\n\t\t\t10'd32  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir32;\n\t\t\t   end\n\t\t\t10'd33  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir33;\n\t\t\t   end\n\t\t\t10'd34  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir34;\n\t\t\t   end\n\t\t\t10'd35  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir35;\n\t\t\t   end\n\t\t\t10'd36  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir36;\n\t\t\t   end\n\t\t\t10'd37  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir37;\n\t\t\t   end\n\t\t\t10'd38  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir38;\n\t\t\t   end\n\t\t\t10'd39  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir39;\n\t\t\t   end\n\t\t\t10'd40  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir40;\n\t\t\t   end\n\t\t\t10'd41  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir41;\n\t\t\t   end\n\t\t\t10'd42  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir42;\n\t\t\t   end\n\t\t\t10'd43  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir43;\n\t\t\t   end\n\t\t\t10'd44  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir44;\n\t\t\t   end\n\t\t\t10'd45  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir45;\n\t\t\t   end\n\t\t\t10'd46  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir46;\n\t\t\t   end\n\t\t\t10'd47  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir47;\n\t\t\t   end\n\t\t\t\n\t\t\tendcase\n\t\t\twrite_sq <= 1'b0;\n\t\t\tread_sq <= 1'b1;\n\t\t\t\n\t\tend\n\t\t\n\t\tSET_DELAY_11:\n\t\tbegin\n\t\t\n\t\tend\n\t\t\n\t\tSET_DELAY_12:\n\t\tbegin\n\t\t\n\t\tend\n\n\t\tADDR_FIR_SQ:\n\t\tbegin\n\t\t\ta1_in1 <= m1_out;\n\t\t\ta1_in2 <= out_sq;\n\t\t\twrite_sq <= 1'b1;\n\t\t\tread_sq <= 1'b0;\n\t\tend\n\n\t\tSET_SQ_FIR:\n\t\tbegin\n\t\t\tin_sq <= a1_out;\n\t\t\t\n\t\tend\n\n\t\tINCR_J_2:\n\t\tbegin\n\t\t\tj <= j + 10'd1;\n\t\tend\n\n\t\tINCR_I3:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\t\t\n\t\tFFT_INIT:\n\t\tbegin\n\t\t\ti <= 10'd0;\n\t\tend\n\n\t\tFFT_ADDR:\n\t\tbegin\n\t\t\taddr_in_real <= i;\n\t\t\taddr_in_imag <= i;\n\t\t\tre_fftr <= 1'b0;\n\t\t\tre_ffti <= 1'b0;\n\t\t\twe_fftr <= 1'b1;\n\t\t\twe_ffti <= 1'b1;\n\t\t\t\n\t\tend\n\n\t\tDELAY_FFT_1:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tDELAY_FFT_2:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tWRITE_FFT_INIT:\n\t\tbegin\n\t\t\twrite_in_fft_real <= 32'b0;\n\t\t\twrite_in_fft_imag <= 32'b0;\n\t\tend\n\n\t\tINCR_I4:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\n\t\tCHECK_I4:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tINIT_FOR_4:\n\t\tbegin\n\t\t\ti <= 10'd0;\n\t\tend\n\n\t\tCHECK_I5:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tCALC_FFT_ADDR:\n\t\tbegin\n\t\t\taddr_nlp_sq <= i * DEC;\n\t\t\tread_sq <= 1'b1;\n\t\t\twrite_sq <= 1'b0;\n\t\t\t\n\t\t\t\n\t\t\taddr_in_real <= i;\n\t\t\tre_fftr <= 1'b0;\n\t\t\twe_fftr <= 1'b1;\n\t\t\t\n\t\t\t\n\t\tend\n\n\t\tFOR_DELAY_1:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tFOR_DELAY_2:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tCALC_FFT_SQ_W:\n\t\tbegin\n\t\t\tm1_in1 <= out_sq;\n\t\t\tcase (i)\n\t\t\t\t10'd0  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w0;\n\t\t\t\t   end\n\t\t\t\t10'd1  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w1;\n\t\t\t\t   end\n\t\t\t\t10'd2  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w2;\n\t\t\t\t   end\n\t\t\t\t10'd3  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w3;\n\t\t\t\t   end\n\t\t\t\t10'd4  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w4;\n\t\t\t\t   end\n\t\t\t\t10'd5  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w5;\n\t\t\t\t   end\n\t\t\t\t10'd6  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w6;\n\t\t\t\t   end\n\t\t\t\t10'd7  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w7;\n\t\t\t\t   end\n\t\t\t\t10'd8  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w8;\n\t\t\t\t   end\n\t\t\t\t10'd9  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w9;\n\t\t\t\t   end\n\t\t\t\t10'd10  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w10;\n\t\t\t\t   end\n\t\t\t\t10'd11  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w11;\n\t\t\t\t   end\n\t\t\t\t10'd12  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w12;\n\t\t\t\t   end\n\t\t\t\t10'd13  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w13;\n\t\t\t\t   end\n\t\t\t\t10'd14  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w14;\n\t\t\t\t   end\n\t\t\t\t10'd15  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w15;\n\t\t\t\t   end\n\t\t\t\t10'd16  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w16;\n\t\t\t\t   end\n\t\t\t\t10'd17  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w17;\n\t\t\t\t   end\n\t\t\t\t10'd18  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w18;\n\t\t\t\t   end\n\t\t\t\t10'd19  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w19;\n\t\t\t\t   end\n\t\t\t\t10'd20  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w20;\n\t\t\t\t   end\n\t\t\t\t10'd21  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w21;\n\t\t\t\t   end\n\t\t\t\t10'd22  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w22;\n\t\t\t\t   end\n\t\t\t\t10'd23  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w23;\n\t\t\t\t   end\n\t\t\t\t10'd24  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w24;\n\t\t\t\t   end\n\t\t\t\t10'd25  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w25;\n\t\t\t\t   end\n\t\t\t\t10'd26  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w26;\n\t\t\t\t   end\n\t\t\t\t10'd27  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w27;\n\t\t\t\t   end\n\t\t\t\t10'd28  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w28;\n\t\t\t\t   end\n\t\t\t\t10'd29  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w29;\n\t\t\t\t   end\n\t\t\t\t10'd30  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w30;\n\t\t\t\t   end\n\t\t\t\t10'd31  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w31;\n\t\t\t\t   end\n\t\t\t\t10'd32  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w32;\n\t\t\t\t   end\n\t\t\t\t10'd33  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w33;\n\t\t\t\t   end\n\t\t\t\t10'd34  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w34;\n\t\t\t\t   end\n\t\t\t\t10'd35  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w35;\n\t\t\t\t   end\n\t\t\t\t10'd36  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w36;\n\t\t\t\t   end\n\t\t\t\t10'd37  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w37;\n\t\t\t\t   end\n\t\t\t\t10'd38  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w38;\n\t\t\t\t   end\n\t\t\t\t10'd39  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w39;\n\t\t\t\t   end\n\t\t\t\t10'd40  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w40;\n\t\t\t\t   end\n\t\t\t\t10'd41  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w41;\n\t\t\t\t   end\n\t\t\t\t10'd42  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w42;\n\t\t\t\t   end\n\t\t\t\t10'd43  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w43;\n\t\t\t\t   end\n\t\t\t\t10'd44  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w44;\n\t\t\t\t   end\n\t\t\t\t10'd45  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w45;\n\t\t\t\t   end\n\t\t\t\t10'd46  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w46;\n\t\t\t\t   end\n\t\t\t\t10'd47  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w47;\n\t\t\t\t   end\n\t\t\t\t10'd48  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w48;\n\t\t\t\t   end\n\t\t\t\t10'd49  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w49;\n\t\t\t\t   end\n\t\t\t\t10'd50  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w50;\n\t\t\t\t   end\n\t\t\t\t10'd51  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w51;\n\t\t\t\t   end\n\t\t\t\t10'd52  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w52;\n\t\t\t\t   end\n\t\t\t\t10'd53  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w53;\n\t\t\t\t   end\n\t\t\t\t10'd54  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w54;\n\t\t\t\t   end\n\t\t\t\t10'd55  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w55;\n\t\t\t\t   end\n\t\t\t\t10'd56  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w56;\n\t\t\t\t   end\n\t\t\t\t10'd57  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w57;\n\t\t\t\t   end\n\t\t\t\t10'd58  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w58;\n\t\t\t\t   end\n\t\t\t\t10'd59  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w59;\n\t\t\t\t   end\n\t\t\t\t10'd60  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w60;\n\t\t\t\t   end\n\t\t\t\t10'd61  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w61;\n\t\t\t\t   end\n\t\t\t\t10'd62  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w62;\n\t\t\t\t   end\n\t\t\t\t10'd63  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w63;\n\t\t\t\t   end\n\t\t\tendcase\n\t\tend\n\n\t\tWRITE_FFT_REAL:\n\t\tbegin\n\t\t\twrite_in_fft_real <= m1_out;\n\t\t\tif(i == 10'd61)\n\t\t\tbegin\n\t\t\t\t\n\t\t\tend\n\t\t\t\n\t\tend\n\n\t\tINCR_I_5:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\t\t\n\t\t\t\n\t\tSTART_DFT:\n\t\tbegin\n\t\t\tstartfft <= 1'b1;\n\t\t\t\n\t\t\tre_fftr <= 1'b1;\n\t\t\twe_fftr <= 1'b0;\n\t\t\tre_ffti <= 1'b1;\n\t\t\twe_ffti <= 1'b0;\n\t\t\t\n\t\t\tre_out_fftr <= 1'b0;\n\t\t\twe_out_fftr <= 1'b1;\n\t\t\tre_out_ffti <= 1'b0;\n\t\t\twe_out_ffti <= 1'b1;\n\t\t\t\n\t\tend\n\t\t\n\t\tRUN_DFT:\n\t\tbegin\n\t\t\tstartfft <= 1'b0;\n\t\t\taddr_in_real <= fft_addr_in_real;\n\t\t\taddr_in_imag <= fft_addr_in_imag;\n\t\t\t\n\t\t\taddr_out_real <= fft_addr_out_real;\n\t\t\taddr_out_imag <= fft_addr_out_imag;\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\twrite_fft_real <= fft_write_fft_real;\n\t\t\twrite_fft_imag <= fft_write_fft_imag;\n\t\tend\n\t\t\n\t\tINIT_FOR_5:\n\t\tbegin\n\t\t\ti <= 10'd0;\n\t\tend\n\n\t\tCHECK_I_6:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_ADDR_FOR_5:\n\t\tbegin\n\t\t\taddr_out_real <= i;\n\t\t\taddr_out_imag <= i;\n\t\t\tre_out_fftr <= 1'b1;\n\t\t\twe_out_fftr <= 1'b0;\n\t\t\tre_out_ffti <= 1'b1;\n\t\t\twe_out_ffti <= 1'b0; \n\t\tend\n\n\t\tFOR_5_DELAY1:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tFOR_5_DELAY2:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tMULT_REAL_IMAGE_SQ:\n\t\tbegin\n\t\t\t\n\n\n\n\n\t\t\t\n\t\t\tm1 <= {17'b0,out_fft_real[N-2:16]};\n\t\t\tm2 <= {17'b0,out_fft_real[N-2:16]};\n\t\t\tm3 <= {17'b0,out_fft_imag[N-2:16]};\n\t\t\tm4 <= {17'b0,out_fft_imag[N-2:16]};\n\t\t\t\n\t\tend\n\n\t\tADD_REAL_IMAG_SQ:\n\t\tbegin\n\t\t\t\n\n\t\t\t\n\t\t\ta1 <= m1 * m2;\n\t\t\ta2 <= m3 * m4;\n\t\t\t\n\t\t\twe_out_fftr_gmax <= 1'b1;\n\t\t\tre_out_fftr_gmax <= 1'b0;\n\t\t\taddr_out_real_gmax <= i;\n\t\t\t\n\t\t\n\t\t\t\n\t\t\t\n\t\tend\n\n\t\tSET_FW_REAL_ADD:\n\t\tbegin\n\t\t\twrite_fft_real_gmax <= a1 + a2;;\n\t\t\t\n\t\tend\n\n\t\tINCR_I6:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend \n\t\t\n\t\tSET_GMAX_GMAX_BIN:\n\t\tbegin\n\t\t\tgmax = 32'b0;\n\t\t\tgmax_bin <= 10'd16;\n\t\tend\n\t\t\n\t\tINIT_FOR_GMAX:\n\t\tbegin\n\t\t\ti <= 10'd16; \n\t\tend\n\t\t\n\t\tCHECK_I_GMAX:\n\t\tbegin\n\t\t\t\n\t\tend\n\t\t\n\t\tSET_ADDR_FW_GMAX:\n\t\tbegin\n\t\t\taddr_out_real_gmax <= i;\n\t\t\tre_out_fftr_gmax <= 1'b1;\n\t\t\twe_out_fftr_gmax <= 1'b0;\n\t\tend\n\t\t\n\t\tSET_DELAY_GMAX1:\n\t\tbegin\n\t\t\n\t\tend\n\t\t\n\t\tSET_DELAY_GMAX2:\n\t\tbegin\n\t\t\n\t\tend\n\t\t\n\t\tSET_IF_GMAX:\n\t\tbegin\n\t\t\tif(out_fft_real_gmax > gmax)\n\t\t\tbegin\n\t\t\t\tgmax <= out_fft_real_gmax;\n\t\t\t\tgmax_bin <= i;\n\t\t\tend\n\t\tend\n\t\t\n\t\tINCR_I_GMAX:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\t\t\n\t\tSTART_PPSM:\n\t\tbegin\n\t\t\tstartppsm <= 1'b1;\n\t\t\tout_fw_real <= out_fft_real_gmax;\n\t\t\tpp_gmax <= gmax;\n\t\t\tpp_gmax_bin <= gmax_bin;\n\t\t\tpp_prev_f0 <= {16'd50,16'd0};\n\t\t\taddr_out_real_gmax <= addr_fw_real;\n\t\tend\n\t\t\n\t\tGET_BESTF0:\n\t\tbegin\n\t\t\tbest_f0 <= pp_best_f0;\n\t\tend\n\t\t\n\t\t\n\t\t\t\n\n\t\t\n\t\tINIT_FOR_SQ:\n\t\tbegin\n\t\t\ti <= 10'd0;\n\t\tend\n\t\t\n\t\tCHECK_FOR_SQ:\n\t\tbegin\n\t\t\t\n\t\tend\n\t\t\n\t\tSET_ADDR_FOR_SQ:\n\t\tbegin\n\t\t\taddr_nlp_sq <= i + 10'd80;\n\t\t\tread_sq <= 1'b1;\n\t\t\twrite_sq <= 1'b0;\n\t\tend\n\t\t\n\t\tFOR_SQ_DELAY1:\n\t\tbegin\n\t\t\n\t\tend\n\t\t\n\t\tFOR_SQ_DELAY2:\n\t\tbegin\n\t\t\n\t\tend\n\t\t\n\t\tGET_SQ_I_N:\n\t\tbegin\n\t\t\tout_sq_i_n <= out_sq;\n\t\t\taddr_nlp_sq <= i;\n\t\t\tread_sq <= 1'b0;\n\t\t\twrite_sq <= 1'b1;\n\t\tend\n\t\t\n\t\tSET_SQ_I_N:\n\t\tbegin\n\t\t\tin_sq <= out_sq_i_n;\n\t\tend\n\t\t\n\t\tINCR_SQ_I:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\t\t\n\t\tSTART_DIV_BEST0:\n\t\tbegin\n\t\t\tstartdiv <= 1'b1;\n\t\t\tdiv_in <= best_f0;\n\t\tend\n\t\t\n\t\tCALC_DIV_BESTF0:\n\t\tbegin\n\t\t\tm1_in1 <= div_ans;\n\t\t\tm1_in2 <= NLP_FS;\n\t\t\tstartdiv <= 1'b0; \n\t\tend\n\t\t\n\t\tSET_PITCH:\n\t\tbegin\n\t\t\tpitch <= m1_out;\n\t\t\tnlp_mem_x_out <= mem_x;\n\t\t\tnlp_mem_y_out <= mem_y;\t\n\t\t\tout_prev_f0 <= best_f0;\n\t\tend\n\t\t\n\t\tDONE:\n\t\tbegin\n\t\t\tdonenlp <= 1'b1;\n\t\tend\n\n\t\tendcase\n\tend\n\nend\n\n\nendmodule```"
        },
        {
            "role": "user",
            "content": "Based on the provided original Verilog code, its comments and above answers, generate a detailed specification for the module. Include the following information in a single, concise paragraph:\n1. The name of the module.\n2. A simple explanation of the module's functionality.\n3. The input and output ports, along with a brief explanation of each.\n4. The internal signals used within the module, with a brief explanation of their purpose.\n5. An overview of the different blocks or sections in the code and their functions.\nEnsure that the specification is clear and accurately reflects the details from the code and comments.\nYour answer should be structured and well-organized, providing a comprehensive and detailed overview of the module's design and operation.\nPlease provide your answer in the following format:\nModule name: [module name]. Module specification: [module specification]."
        },
        {
            "role": "assistant",
            "content": "Module name: nlp_test. Module specification: The nlp_test module implements a Non-Linear Pitch (NLP) estimation algorithm for speech processing. It performs notch filtering, FIR filtering, FFT computation, and post-processing to estimate the pitch of an input signal. The module has input ports for initiating the algorithm (startnlp), clock (clk), reset (rst), initial memory values (nlp_mem_x, nlp_mem_y), and previous fundamental frequency (prev_f0). Output ports include the best estimated fundamental frequency (best_f0), previous fundamental frequency (out_prev_f0), completion indicator (donenlp), estimated pitch (pitch), and updated memory values (nlp_mem_x_out, nlp_mem_y_out). Internally, it uses various signals for state management, memory addressing, arithmetic operations, and control flags. The module is structure"
        }
    ],
    "claude-message": [
        {
            "role": "user",
            "content": [
                {
                    "type": "text",
                    "text": "You are an expert in hardware design with a deep understanding of Verilog RTL codes. Now I want to train a large language model for code comment generation tasks specifically focused on Verilog RTL codes. And I want you to help me process the raw data, transforming it into suitable formats that can serve as inputs and outputs for the model."
                },
                {
                    "type": "text",
                    "text": "Name of the module and its functionality is as follows: \nModule name: nlp_test\n\nExplanation: This module appears to implement a Non-Linear Pitch (NLP) estimation algorithm for speech processing. It performs several operations including notch filtering, FIR filtering, FFT computation, and post-processing to estimate the pitch of an input signal. The module goes through multiple stages of processing, including data initialization, filtering, FFT calculation, and pitch estimation. It uses various memory blocks and arithmetic operations to process the input data and ultimately output a pitch value along with other related parameters."
                },
                {
                    "type": "text",
                    "text": "Input and output ports and their explanation is as follows: \nInput ports:\nstartnlp, clk, rst, nlp_mem_x, nlp_mem_y, prev_f0\n\nExplanation:\n- startnlp: Initiates the NLP algorithm\n- clk: Clock signal for synchronous operations\n- rst: Reset signal\n- nlp_mem_x, nlp_mem_y: Initial memory values for notch filter\n- prev_f0: Previous fundamental frequency estimate\n\nOutput ports:\nbest_f0, out_prev_f0, donenlp, pitch, nlp_mem_x_out, nlp_mem_y_out\n\nExplanation:\n- best_f0: Best estimated fundamental frequency\n- out_prev_f0: Output of the previous fundamental frequency\n- donenlp: Indicates completion of NLP algorithm\n- pitch: Estimated pitch value\n- nlp_mem_x_out, nlp_mem_y_out: Updated memory values for notch filter"
                },
                {
                    "type": "text",
                    "text": "Internal signals and their explanation is as follows: \nInternal signals:\nSTATE, NEXT_STATE, i, j, addr_nlp_sq, addr_mem_fir, addr_sn, in_sq, in_mem_fir, out_sq, out_mem_fir, read_sq, write_sq, read_fir, write_fir, notch, mem_x, mem_y, mem_fir_j_1, startdiv, div_in, div_ans, out_sn, donediv, m1_in1, m1_in2, m1_out, a1_in1, a1_in2, a1_out, m2_in1, m2_in2, m2_out, a2_in1, a2_in2, a2_out, addr_in_imag, addr_in_real, addr_out_real, addr_out_imag, write_fft_real, write_fft_imag, startfft, donefft, gmax, gmax_bin, startppsm, out_fw_real, pp_gmax, pp_prev_f0, doneppsm, out_sq_i_n.\n\nExplanation:\n- STATE, NEXT_STATE: Represent the current and next states of the FSM controlling the module's operation.\n- i, j: Loop counters used in various operations.\n- addr_nlp_sq, addr_mem_fir, addr_sn: Address signals for different memory blocks.\n- in_sq, in_mem_fir: Input data for square and FIR memory blocks.\n- out_sq, out_mem_fir, out_sn: Output data from square, FIR, and sn memory blocks.\n- read_sq, write_sq, read_fir, write_fir: Control signals for reading/writing to memory blocks.\n- notch, mem_x, mem_y: Signals used in notch filtering.\n- mem_fir_j_1: Temporary storage for FIR filter operation.\n- startdiv, div_in, div_ans, donediv: Signals for division operation.\n- m1_in1, m1_in2, m1_out, a1_in1, a1_in2, a1_out, m2_in1, m2_in2, m2_out, a2_in1, a2_in2, a2_out: Signals for multiplication and addition operations.\n- addr_in_imag, addr_in_real, addr_out_real, addr_out_imag: Address signals for FFT input/output.\n- write_fft_real, write_fft_imag: Data to be written to FFT memory.\n- startfft, donefft: Control signals for FFT operation.\n- gmax, gmax_bin: Maximum value and its bin in FFT output.\n- startppsm, doneppsm: Control signals for post-processing sub-multiples.\n- out_fw_real, pp_gmax, pp_prev_f0: Signals used in post-processing.\n- out_sq_i_n: Temporary storage for square operation."
                },
                {
                    "type": "text",
                    "text": "Original Verilog code is as follows: \n<code>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmodule nlp_test (startnlp,clk,rst,nlp_mem_x,nlp_mem_y,prev_f0,best_f0,out_prev_f0,pitch,nlp_mem_x_out,nlp_mem_y_out,donenlp);\n\n\n\n\n\n\t\t\tparameter N = 32;\n\t\t\tparameter Q = 16;\n\n\t\t\tinput clk,rst,startnlp;\n\t\t\tinput [N-1:0] nlp_mem_x,nlp_mem_y;\n\t\t\t\n\t\t\t\n\t\t\tinput [N-1:0] prev_f0;\n\t\t\toutput reg [N-1:0] best_f0,out_prev_f0;\n\n\t\t\toutput reg donenlp;\n\t\t\toutput reg [N-1:0] pitch;\n\t\t\toutput reg [N-1:0] nlp_mem_x_out,nlp_mem_y_out;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\n\t\t\t\n\n\n\n\n\nparameter START = 8'd0,\n          INIT_FOR_1 = 8'd1,\n          CHECK_I = 8'd2,\n          READ_SN = 8'd3,\n          SET_DELAY_1 = 8'd4,\n          SET_DELAY_2 = 8'd5,\n          CALC_SN_SQ = 8'd6,\n          SET_NLP_SQ = 8'd7,\n          INCR_I = 8'd8,\n\t\t\t INIT_FOR_2 = 8'd9,\n          CHECK_I_2 = 8'd10,\n          SET_ADDR_SQ_2 = 8'd11,\n          SET_DELAY_3 = 8'd12,\n          SET_DELAY_4 = 8'd13,\n          NOTCH_1 = 8'd14,\n          NOTCH_2 = 8'd15,\n          SET_MEM_X = 8'd16,\n          SET_MEM_Y = 8'd17,\n          SET_NEW_SQ_1 = 8'd18,\n          SET_NEW_SQ_2 = 8'd19,\n          INCR_I_2 = 8'd20,\n\t\t    INIT_FOR_3 = 8'd21,\n          CHECK_I_3 = 8'd22,\n          INNER_FOR_1 = 8'd23,\n          CHECK_J = 8'd24,\n          SET_ADDR_FIR = 8'd25,\n          SET_DELAY_5 = 8'd26,\n          SET_DELAY_6 = 8'd27,\n          GET_FIR_1 = 8'd28,\n          ADDR_WRITE_FIR = 8'd29,\n          GET_FIR_2 = 8'd30,\n          INCR_J = 8'd31,\n          ADDR_LAST_FIR = 8'd32,\n          SET_DELAY_7 = 8'd33,\n          SET_DELAY_8 = 8'd34,\n          SET_LAST_FIR = 8'd35,\n          INNER_FOR_2 = 8'd36,\n          CHECK_J_2 = 8'd37,\n          READ_FIR1 = 8'd38,\n          SET_DELAY_9 = 8'd39,\n          SET_DELAY_10 = 8'd40,\n          MULT_NLP_FIR = 8'd41,\n          ADDR_FIR_SQ = 8'd42,\n          SET_SQ_FIR = 8'd43,\n          INCR_J_2 = 8'd44,\n          INCR_I3 = 8'd45,\n          DONE = 8'd46,\n\t\t    SET_SQ_0 = 8'd47,\n\t\t    SET_DELAY_11 = 8'd48,\n\t\t    SET_DELAY_12 = 8'd49,\n\t\t    FFT_INIT = 8'd50,\n          FFT_ADDR = 8'd51,\n          DELAY_FFT_1 = 8'd52,\n          DELAY_FFT_2 = 8'd53,\n          WRITE_FFT_INIT = 8'd54,\n          INCR_I4 = 8'd55,\n          CHECK_I4 = 8'd56,\n          INIT_FOR_4 = 8'd57,\n          CHECK_I5 = 8'd58,\n          CALC_FFT_ADDR = 8'd59,\n          FOR_DELAY_1 = 8'd60,\n          FOR_DELAY_2 = 8'd61,\n          CALC_FFT_SQ_W = 8'd62,\n          WRITE_FFT_REAL = 8'd63,\n          INCR_I_5 = 8'd64,\n\t\t    START_DFT = 8'd65,\n\t\t    RUN_DFT = 8'd66,\n\t\t    INIT_FOR_5 = 8'd67,\n          CHECK_I_6 = 8'd68,\n          SET_ADDR_FOR_5 = 8'd69,\n          FOR_5_DELAY1 = 8'd70,\n          FOR_5_DELAY2 = 8'd71,\n          MULT_REAL_IMAGE_SQ = 8'd72,\n          ADD_REAL_IMAG_SQ = 8'd73,\n          SET_FW_REAL_ADD = 8'd74,\n          INCR_I6 = 8'd75,\n\t\t    RUN_DFT_2 = 8'd76,\n\t\t\t SET_GMAX_GMAX_BIN = 8'd77,\n\t\t\t INIT_FOR_GMAX = 8'd78,\n\t\t\t CHECK_I_GMAX = 8'd79,\n\t\t\t SET_ADDR_FW_GMAX = 8'd80,\n\t\t\t SET_DELAY_GMAX1 = 8'd81,\n\t\t\t SET_DELAY_GMAX2 = 8'd82,\n\t\t\t SET_IF_GMAX = 8'd83,\n\t\t\t INCR_I_GMAX = 8'd84,\n\t\t\t START_PPSM = 8'd85,\n\t\t\t GET_BESTF0 = 8'd86,\n\t\t\t INIT_FOR_SQ = 8'd87,\n\t\t\t CHECK_FOR_SQ = 8'd88,\n\t\t\t SET_ADDR_FOR_SQ = 8'd89,\n\t\t\t FOR_SQ_DELAY1 = 8'd90,\n\t\t\t FOR_SQ_DELAY2 = 8'd91,\n\t\t\t GET_SQ_I_N = 8'd92,\n\t\t\t SET_SQ_I_N = 8'd93,\n\t\t\t INCR_SQ_I = 8'd94,\n\t\t\t START_DIV_BEST0 = 8'd95,\n\t\t\t CALC_DIV_BESTF0 = 8'd96,\n\t\t\t SET_PITCH = 8'd97;\n\t\t  \n\nreg [7:0] STATE, NEXT_STATE;\n\nparameter [9:0] M = 10'd320,\n\t\t\t\tN_SAMP = 10'd80,\n\t\t\t\tDEC = 10'd5;\n\t\t\t\t\nparameter [N-1:0] COEFF \t= 32'b00000000000000001111001100110011,\n\t\t\t\t\t\tONE   \t= 32'b00000000000000010000000000000000,\n\t\t\t\t\t\tNLP_FS \t= {16'd8000,16'd0};\n\t\t\t\t  \nparameter [N-1:0] \tnlp_fir0  = 32'b10000000000000000000000001000110,\n\t\t\t\t\tnlp_fir1  = 32'b10000000000000000000000001001000,\n\t\t\t\t\tnlp_fir2  = 32'b10000000000000000000000000111100,\n\t\t\t\t\tnlp_fir3  = 32'b10000000000000000000000000011011,\n\t\t\t\t\tnlp_fir4  = 32'b00000000000000000000000000100100,\n\t\t\t\t\tnlp_fir5  = 32'b00000000000000000000000010000011,\n\t\t\t\t\tnlp_fir6  = 32'b00000000000000000000000011110010,\n\t\t\t\t\tnlp_fir7  = 32'b00000000000000000000000101010001,\n\t\t\t\t\tnlp_fir8  = 32'b00000000000000000000000101101110,\n\t\t\t\t\tnlp_fir9  = 32'b00000000000000000000000100011010,\n\t\t\t\t\tnlp_fir10  = 32'b00000000000000000000000000110100,\n\t\t\t\t\tnlp_fir11  = 32'b10000000000000000000000100111011,\n\t\t\t\t\tnlp_fir12  = 32'b10000000000000000000001011111111,\n\t\t\t\t\tnlp_fir13  = 32'b10000000000000000000010010101000,\n\t\t\t\t\tnlp_fir14  = 32'b10000000000000000000010110100110,\n\t\t\t\t\tnlp_fir15  = 32'b10000000000000000000010101011011,\n\t\t\t\t\tnlp_fir16  = 32'b10000000000000000000001101000111,\n\t\t\t\t\tnlp_fir17  = 32'b00000000000000000000000011010011,\n\t\t\t\t\tnlp_fir18  = 32'b00000000000000000000011011010100,\n\t\t\t\t\tnlp_fir19  = 32'b00000000000000000000111000110110,\n\t\t\t\t\tnlp_fir20  = 32'b00000000000000000001011000011000,\n\t\t\t\t\tnlp_fir21  = 32'b00000000000000000001110101100011,\n\t\t\t\t\tnlp_fir22  = 32'b00000000000000000010001100000001,\n\t\t\t\t\tnlp_fir23  = 32'b00000000000000000010011000001111,\n\t\t\t\t\tnlp_fir24  = 32'b00000000000000000010011000001111,\n\t\t\t\t\tnlp_fir25  = 32'b00000000000000000010001100000001,\n\t\t\t\t\tnlp_fir26  = 32'b00000000000000000001110101100011,\n\t\t\t\t\tnlp_fir27  = 32'b00000000000000000001011000011000,\n\t\t\t\t\tnlp_fir28  = 32'b00000000000000000000111000110110,\n\t\t\t\t\tnlp_fir29  = 32'b00000000000000000000011011010100,\n\t\t\t\t\tnlp_fir30  = 32'b00000000000000000000000011010011,\n\t\t\t\t\tnlp_fir31  = 32'b10000000000000000000001101000111,\n\t\t\t\t\tnlp_fir32  = 32'b10000000000000000000010101011011,\n\t\t\t\t\tnlp_fir33  = 32'b10000000000000000000010110100110,\n\t\t\t\t\tnlp_fir34  = 32'b10000000000000000000010010101000,\n\t\t\t\t\tnlp_fir35  = 32'b10000000000000000000001011111111,\n\t\t\t\t\tnlp_fir36  = 32'b10000000000000000000000100111011,\n\t\t\t\t\tnlp_fir37  = 32'b00000000000000000000000000110100,\n\t\t\t\t\tnlp_fir38  = 32'b00000000000000000000000100011010,\n\t\t\t\t\tnlp_fir39  = 32'b00000000000000000000000101101110,\n\t\t\t\t\tnlp_fir40  = 32'b00000000000000000000000101010001,\n\t\t\t\t\tnlp_fir41  = 32'b00000000000000000000000011110010,\n\t\t\t\t\tnlp_fir42  = 32'b00000000000000000000000010000011,\n\t\t\t\t\tnlp_fir43  = 32'b00000000000000000000000000100100,\n\t\t\t\t\tnlp_fir44  = 32'b10000000000000000000000000011011,\n\t\t\t\t\tnlp_fir45  = 32'b10000000000000000000000000111100,\n\t\t\t\t\tnlp_fir46  = 32'b10000000000000000000000001001000,\n\t\t\t\t\tnlp_fir47  = 32'b10000000000000000000000001000110;\n\t\t\t\t\t\nparameter [N-1:0] \tnlp_w0  = 32'b00000000000000000000000000000000,\n\t\t\t\t\tnlp_w1  = 32'b00000000000000000000000010100010,\n\t\t\t\t\tnlp_w2  = 32'b00000000000000000000001010001001,\n\t\t\t\t\tnlp_w3  = 32'b00000000000000000000010110101111,\n\t\t\t\t\tnlp_w4  = 32'b00000000000000000000101000001101,\n\t\t\t\t\tnlp_w5  = 32'b00000000000000000000111110010110,\n\t\t\t\t\tnlp_w6  = 32'b00000000000000000001011000111101,\n\t\t\t\t\tnlp_w7  = 32'b00000000000000000001110111110010,\n\t\t\t\t\tnlp_w8  = 32'b00000000000000000010011010100000,\n\t\t\t\t\tnlp_w9  = 32'b00000000000000000011000000110001,\n\t\t\t\t\tnlp_w10  = 32'b00000000000000000011101010001101,\n\t\t\t\t\tnlp_w11  = 32'b00000000000000000100010110011010,\n\t\t\t\t\tnlp_w12  = 32'b00000000000000000101000100111100,\n\t\t\t\t\tnlp_w13  = 32'b00000000000000000101110101010101,\n\t\t\t\t\tnlp_w14  = 32'b00000000000000000110100111000101,\n\t\t\t\t\tnlp_w15  = 32'b00000000000000000111011001101111,\n\t\t\t\t\tnlp_w16  = 32'b00000000000000001000001100110000,\n\t\t\t\t\tnlp_w17  = 32'b00000000000000001000111111101010,\n\t\t\t\t\tnlp_w18  = 32'b00000000000000001001110001111011,\n\t\t\t\t\tnlp_w19  = 32'b00000000000000001010100011000100,\n\t\t\t\t\tnlp_w20  = 32'b00000000000000001011010010100101,\n\t\t\t\t\tnlp_w21  = 32'b00000000000000001100000000000000,\n\t\t\t\t\tnlp_w22  = 32'b00000000000000001100101010111000,\n\t\t\t\t\tnlp_w23  = 32'b00000000000000001101010010110010,\n\t\t\t\t\tnlp_w24  = 32'b00000000000000001101110111010100,\n\t\t\t\t\tnlp_w25  = 32'b00000000000000001110011000001000,\n\t\t\t\t\tnlp_w26  = 32'b00000000000000001110110100111000,\n\t\t\t\t\tnlp_w27  = 32'b00000000000000001111001101010010,\n\t\t\t\t\tnlp_w28  = 32'b00000000000000001111100001000111,\n\t\t\t\t\tnlp_w29  = 32'b00000000000000001111110000001010,\n\t\t\t\t\tnlp_w30  = 32'b00000000000000001111111010010001,\n\t\t\t\t\tnlp_w31  = 32'b00000000000000001111111111010111,\n\t\t\t\t\tnlp_w32  = 32'b00000000000000001111111111010111,\n\t\t\t\t\tnlp_w33  = 32'b00000000000000001111111010010001,\n\t\t\t\t\tnlp_w34  = 32'b00000000000000001111110000001010,\n\t\t\t\t\tnlp_w35  = 32'b00000000000000001111100001000111,\n\t\t\t\t\tnlp_w36  = 32'b00000000000000001111001101010010,\n\t\t\t\t\tnlp_w37  = 32'b00000000000000001110110100111000,\n\t\t\t\t\tnlp_w38  = 32'b00000000000000001110011000001000,\n\t\t\t\t\tnlp_w39  = 32'b00000000000000001101110111010100,\n\t\t\t\t\tnlp_w40  = 32'b00000000000000001101010010110010,\n\t\t\t\t\tnlp_w41  = 32'b00000000000000001100101010111000,\n\t\t\t\t\tnlp_w42  = 32'b00000000000000001100000000000000,\n\t\t\t\t\tnlp_w43  = 32'b00000000000000001011010010100101,\n\t\t\t\t\tnlp_w44  = 32'b00000000000000001010100011000100,\n\t\t\t\t\tnlp_w45  = 32'b00000000000000001001110001111011,\n\t\t\t\t\tnlp_w46  = 32'b00000000000000001000111111101010,\n\t\t\t\t\tnlp_w47  = 32'b00000000000000001000001100110000,\n\t\t\t\t\tnlp_w48  = 32'b00000000000000000111011001101111,\n\t\t\t\t\tnlp_w49  = 32'b00000000000000000110100111000101,\n\t\t\t\t\tnlp_w50  = 32'b00000000000000000101110101010101,\n\t\t\t\t\tnlp_w51  = 32'b00000000000000000101000100111100,\n\t\t\t\t\tnlp_w52  = 32'b00000000000000000100010110011010,\n\t\t\t\t\tnlp_w53  = 32'b00000000000000000011101010001101,\n\t\t\t\t\tnlp_w54  = 32'b00000000000000000011000000110001,\n\t\t\t\t\tnlp_w55  = 32'b00000000000000000010011010100000,\n\t\t\t\t\tnlp_w56  = 32'b00000000000000000001110111110010,\n\t\t\t\t\tnlp_w57  = 32'b00000000000000000001011000111101,\n\t\t\t\t\tnlp_w58  = 32'b00000000000000000000111110010110,\n\t\t\t\t\tnlp_w59  = 32'b00000000000000000000101000001101,\n\t\t\t\t\tnlp_w60  = 32'b00000000000000000000010110101111,\n\t\t\t\t\tnlp_w61  = 32'b00000000000000000000001010001001,\n\t\t\t\t\tnlp_w62  = 32'b00000000000000000000000010100010,\n\t\t\t\t\tnlp_w63  = 32'b00000000000000000000000000000000;\n\n\n\n\n\nreg [9:0] i,j;\nreg \t\t\t[N-1:0] \t\tm1_in1,m1_in2,a1_in1,a1_in2,m2_in1,m2_in2,a2_in1,a2_in2;\nwire \t\t\t[N-1:0] \t\tm1_out,a1_out,m2_out,a2_out;\n\nreg [9:0] addr_nlp_sq,addr_mem_fir,addr_sn;\nreg [N-1:0] in_sq,in_mem_fir;\nwire [N-1:0] out_sq,out_mem_fir;\n\nreg [N-1:0] m1,m2,m3,m4,a1,a2;\n\nreg read_sq,write_sq,read_fir,write_fir;\n\nreg [N-1:0] notch,mem_x,mem_y;\n\nreg [N-1:0] mem_fir_j_1;\nreg startdiv;\nreg [N-1:0] div_in;\nwire [N-1:0] div_ans,out_sn;\nwire donediv;\n\nqmult  \t\t\t#(Q,N) \t\t\tqmult1\t   (m1_in1,m1_in2,m1_out);\nqadd   \t\t\t#(Q,N)\t\t\tadder1     (a1_in1,a1_in2,a1_out);\n\nqmult  \t\t\t#(Q,N) \t\t\tqmult2\t   (m2_in1,m2_in2,m2_out);\nqadd   \t\t\t#(Q,N)\t\t\tadder2     (a2_in1,a2_in2,a2_out);\n\nfpdiv_clk  \t  \t \t\t\t\tdivider\t   (startdiv,clk,rst,div_in,div_ans,donediv);\n\n\nRAM_nlp_c2_sn    in_sn\t   (addr_sn,clk,,1,0,out_sn);\nRAM_nlp_sq       nlp_sq\t       (addr_nlp_sq,clk,in_sq,read_sq,write_sq,out_sq);\nRAM_nlp_mem_fir  mem_fir   (addr_mem_fir,clk,in_mem_fir,read_fir,write_fir,out_mem_fir);\n\n\nreg [9:0] \t\taddr_in_imag,addr_in_real,addr_out_real,addr_out_imag;\nwire   [N-1:0]\t\tin_imag_data,in_real_data;\n\t\t\nwire [9:0] fft_addr_in_imag,fft_addr_in_real,fft_addr_out_real,fft_addr_out_imag;\n reg [N-1:0] write_fft_real;\n reg [N-1:0] write_fft_imag; \n\nreg [9:0] addr_out_real_gmax,gmax_bin;\nreg [N-1:0] write_fft_real_gmax;\n reg [N-1:0] gmax;\n\n\n\nwire [N-1:0] out_fft_real, out_fft_imag,fft_write_fft_real,fft_write_fft_imag,out_fft_real_gmax;\n\nreg read_in_fftr,read_in_ffti,write_in_fftr,write_in_ffti,re_out_fftr_gmax,we_out_fftr_gmax,\n\t\t\tre_fftr,re_ffti,we_fftr,we_ffti,re_out_fftr,re_out_ffti,we_out_fftr,we_out_ffti,startfft;\nreg [N-1:0] write_in_fft_real,write_in_fft_imag;\nwire donefft,doneppsm;\n\nRAM_in_fft_real            in_real\t   (addr_in_real,clk,write_in_fft_real,re_fftr,we_fftr,in_real_data);\nRAM_in_fft_imag      \t\tin_imag\t   (addr_in_imag,clk,write_in_fft_imag,re_ffti,we_ffti,in_imag_data);\n\nRAM_out_fft_real         fft_out_real\t   (addr_out_real,clk,write_fft_real,re_out_fftr,we_out_fftr,out_fft_real);\nRAM_out_fft_imag      \t fft_out_imag\t   (addr_out_imag,clk,write_fft_imag,re_out_ffti,we_out_ffti,out_fft_imag);\n\nRAM_out_fft_real_gmax    fft_out_real_gmax\t   (addr_out_real_gmax,clk,write_fft_real_gmax,re_out_fftr_gmax,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twe_out_fftr_gmax,out_fft_real_gmax);\n\n\nfft_nlp fft_nlp_module (startfft,clk,rst,in_imag_data,in_real_data,\n\t\t\t\t\tfft_addr_in_imag,fft_addr_in_real,fft_addr_out_real,fft_addr_out_imag,\n\t\t\t\t\t\t\t\tfft_write_fft_real,fft_write_fft_imag,donefft);\n\t\t\t\t\t\t\t\t\npost_process_sub_multiples ppsm (startppsm,clk,rst,out_fw_real,\n\t\t\t\t\t\t\tpp_gmax,pp_gmax_bin,pp_prev_f0,pp_best_f0,addr_fw_real,doneppsm);\n\t\t\t\t\t\t\t\nreg startppsm;\nreg [N-1:0] out_fw_real,pp_gmax;\nreg [9:0] pp_gmax_bin;\nreg [N-1:0] pp_prev_f0;\nwire [N-1:0] pp_best_f0;\nwire [9:0] addr_fw_real;\nreg [N-1:0] out_sq_i_n;\n\n\n\n\n\n\nalways@(posedge clk or negedge rst)     \nbegin\n\n\tif (rst == 1'b0)\n\t\tSTATE <= START;\n\telse\n\t\tSTATE <= NEXT_STATE;\n\nend\n\n\nalways@(*)                              \nbegin\n\tcase(STATE)\n\n\tSTART:\n\tbegin\n\t\tif(startnlp == 1'b1)\n\t\tbegin\n\t\t\tNEXT_STATE = INIT_FOR_1;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = START;\n\t\tend\n\tend\n\n\tINIT_FOR_1:\n\tbegin\n\t\tNEXT_STATE = CHECK_I;\n\tend\n\n\tCHECK_I:\n\tbegin\n\t\tif(i < M)\n\t\tbegin\n\t\t\tNEXT_STATE = READ_SN;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = INIT_FOR_2;\n\t\tend\n\tend\n\n\tREAD_SN:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_1;\n\tend\n\n\tSET_DELAY_1:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_2;\n\tend\n\n\tSET_DELAY_2:\n\tbegin\n\t\tNEXT_STATE = CALC_SN_SQ;\n\tend\n\n\tCALC_SN_SQ:\n\tbegin\n\t\tNEXT_STATE = SET_NLP_SQ;\n\tend\n\n\tSET_NLP_SQ:\n\tbegin\n\t\tNEXT_STATE = INCR_I;\n\tend\n\n\tINCR_I:\n\tbegin\n\t\tNEXT_STATE = CHECK_I;\n\tend\n\t\n\tINIT_FOR_2:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_2;\n\tend\n\n\tCHECK_I_2:\n\tbegin\n\t\tif(i < M)\n\t\tbegin\n\t\t\tNEXT_STATE = SET_ADDR_SQ_2;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = INIT_FOR_3;\n\t\tend\n\tend\n\n\tSET_ADDR_SQ_2:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_3;\n\tend\n\n\tSET_DELAY_3:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_4;\n\tend\n\n\tSET_DELAY_4:\n\tbegin\n\t\tNEXT_STATE = NOTCH_1;\n\tend\n\n\tNOTCH_1:\n\tbegin\n\t\tNEXT_STATE = NOTCH_2;\n\tend\n\n\tNOTCH_2:\n\tbegin\n\t\tNEXT_STATE = SET_MEM_X;\n\tend\n\n\tSET_MEM_X:\n\tbegin\n\t\tNEXT_STATE = SET_MEM_Y;\n\tend\n\n\tSET_MEM_Y:\n\tbegin\n\t\tNEXT_STATE = SET_NEW_SQ_1;\n\tend\n\n\tSET_NEW_SQ_1:\n\tbegin\n\t\tNEXT_STATE = SET_NEW_SQ_2;\n\tend\n\n\tSET_NEW_SQ_2:\n\tbegin\n\t\tNEXT_STATE = INCR_I_2;\n\tend\n\n\tINCR_I_2:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_2;\n\tend\n\t\n\tINIT_FOR_3:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_3;\n\tend\n\n\tCHECK_I_3:\n\tbegin\n\t\tif(i < M)\n\t\tbegin\n\t\t\tNEXT_STATE = INNER_FOR_1;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = FFT_INIT;\n\t\tend\n\tend\n\n\tINNER_FOR_1:\n\tbegin\n\t\tNEXT_STATE = CHECK_J;\n\tend\n\n\tCHECK_J:\n\tbegin\n\t\tif(j < 10'd47)\n\t\tbegin\n\t\t\tNEXT_STATE = SET_ADDR_FIR;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = ADDR_LAST_FIR;\n\t\tend\n\tend\n\n\tSET_ADDR_FIR:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_5;\n\tend\n\n\tSET_DELAY_5:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_6;\n\tend\n\n\tSET_DELAY_6:\n\tbegin\n\t\tNEXT_STATE = GET_FIR_1;\n\tend\n\n\tGET_FIR_1:\n\tbegin\n\t\tNEXT_STATE = ADDR_WRITE_FIR;\n\tend\n\n\tADDR_WRITE_FIR:\n\tbegin\n\t\tNEXT_STATE = GET_FIR_2;\n\tend\n\n\tGET_FIR_2:\n\tbegin\n\t\tNEXT_STATE = INCR_J;\n\tend\n\n\tINCR_J:\n\tbegin\n\t\tNEXT_STATE = CHECK_J;\n\tend\n\n\tADDR_LAST_FIR:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_7;\n\tend\n\n\tSET_DELAY_7:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_8;\n\tend\n\n\tSET_DELAY_8:\n\tbegin\n\t\tNEXT_STATE = SET_LAST_FIR;\n\tend\n\n\tSET_LAST_FIR:\n\tbegin\n\t\tNEXT_STATE = SET_SQ_0;\n\tend\n\t\n\tSET_SQ_0:\n\tbegin\n\t\tNEXT_STATE = INNER_FOR_2;\n\tend\n\n\tINNER_FOR_2:\n\tbegin\n\t\tNEXT_STATE = CHECK_J_2;\n\tend\n\n\tCHECK_J_2:\n\tbegin\n\t\tif(j < 10'd48)\n\t\tbegin\n\t\t\tNEXT_STATE = READ_FIR1;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = INCR_I3;\n\t\tend\n\tend\n\n\tREAD_FIR1:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_9;\n\tend\n\n\tSET_DELAY_9:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_10;\n\tend\n\n\tSET_DELAY_10:\n\tbegin\n\t\tNEXT_STATE = MULT_NLP_FIR;\n\tend\n\n\tMULT_NLP_FIR:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_11;\n\tend\n\t\n\tSET_DELAY_11:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_12;\n\tend\n\t\t\n\tSET_DELAY_12:\n\tbegin\n\t\tNEXT_STATE = ADDR_FIR_SQ;\n\tend\n\n\tADDR_FIR_SQ:\n\tbegin\n\t\tNEXT_STATE = SET_SQ_FIR;\n\tend\n\n\tSET_SQ_FIR:\n\tbegin\n\t\tNEXT_STATE = INCR_J_2;\n\tend\n\n\tINCR_J_2:\n\tbegin\n\t\tNEXT_STATE = CHECK_J_2;\n\tend\n\n\tINCR_I3:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_3;\n\tend\n\t\n\tFFT_INIT:\n\tbegin\n\t\tNEXT_STATE = FFT_ADDR;\n\tend\n\n\tFFT_ADDR:\n\tbegin\n\t\tNEXT_STATE = DELAY_FFT_1;\n\tend\n\n\tDELAY_FFT_1:\n\tbegin\n\t\tNEXT_STATE = DELAY_FFT_2;\n\tend\n\n\tDELAY_FFT_2:\n\tbegin\n\t\tNEXT_STATE = WRITE_FFT_INIT;\n\tend\n\n\tWRITE_FFT_INIT:\n\tbegin\n\t\tNEXT_STATE = INCR_I4;\n\tend\n\n\tINCR_I4:\n\tbegin\n\t\tNEXT_STATE = CHECK_I4;\n\tend\n\n\tCHECK_I4:\n\tbegin\n\t\tif(i < 10'd512)\n\t\tbegin\n\t\t\tNEXT_STATE = FFT_ADDR;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = INIT_FOR_4;\n\t\tend\n\t\t\n\tend\n\n\tINIT_FOR_4:\n\tbegin\n\t\tNEXT_STATE = CHECK_I5;\n\tend\n\n\tCHECK_I5:\n\tbegin\n\t\tif(i < 10'd64)\n\t\tbegin\n\t\t\tNEXT_STATE = CALC_FFT_ADDR;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = START_DFT;  \n\t\tend\n\t\t\n\tend\n\n\tCALC_FFT_ADDR:\n\tbegin\n\t\tNEXT_STATE = FOR_DELAY_1;\n\tend\n\n\tFOR_DELAY_1:\n\tbegin\n\t\tNEXT_STATE = FOR_DELAY_2;\n\tend\n\n\tFOR_DELAY_2:\n\tbegin\n\t\tNEXT_STATE = CALC_FFT_SQ_W;\n\tend\n\n\tCALC_FFT_SQ_W:\n\tbegin\n\t\tNEXT_STATE = WRITE_FFT_REAL;\n\tend\n\n\tWRITE_FFT_REAL:\n\tbegin\n\t\tNEXT_STATE = INCR_I_5;\n\tend\n\n\tINCR_I_5:\n\tbegin\n\t\tNEXT_STATE = CHECK_I5;\n\tend\n\t\n\tSTART_DFT:\n\tbegin\n\t\tNEXT_STATE = RUN_DFT;\n\tend\n\t\n\tRUN_DFT:\n\tbegin\n\t\tif(donefft)\n\t\tbegin\n\t\t\tNEXT_STATE = INIT_FOR_5;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = RUN_DFT;\n\t\tend\n\tend\n\t\n\t\n\t\n\t\n\t\n\t\n\tINIT_FOR_5:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_6;\n\tend\n\n\tCHECK_I_6:\n\tbegin\n\t\tif(i < 10'd512)\n\t\tbegin\n\t\t\tNEXT_STATE = SET_ADDR_FOR_5;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = SET_GMAX_GMAX_BIN;\n\t\tend\n\tend\n\n\tSET_ADDR_FOR_5:\n\tbegin\n\t\tNEXT_STATE = FOR_5_DELAY1;\n\tend\n\n\tFOR_5_DELAY1:\n\tbegin\n\t\tNEXT_STATE = FOR_5_DELAY2;\n\tend\n\n\tFOR_5_DELAY2:\n\tbegin\n\t\tNEXT_STATE = MULT_REAL_IMAGE_SQ;\n\tend\n\n\tMULT_REAL_IMAGE_SQ:\n\tbegin\n\t\tNEXT_STATE = ADD_REAL_IMAG_SQ;\n\tend\n\n\tADD_REAL_IMAG_SQ:\n\tbegin\n\t\tNEXT_STATE = SET_FW_REAL_ADD;\n\tend\n\n\tSET_FW_REAL_ADD:\n\tbegin\n\t\tNEXT_STATE = INCR_I6;\n\tend\n\n\tINCR_I6:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_6;\n\tend\n\t\n\tSET_GMAX_GMAX_BIN:\n\tbegin\n\t\tNEXT_STATE = INIT_FOR_GMAX;\n\tend\n\t\n\tINIT_FOR_GMAX:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_GMAX;\n\tend\n\t\n\tCHECK_I_GMAX:\n\tbegin\n\t\tif(i <= 10'd128)\n\t\tbegin\n\t\t\tNEXT_STATE = SET_ADDR_FW_GMAX;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = START_PPSM;\n\t\tend\n\tend\n\t\n\tSET_ADDR_FW_GMAX:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_GMAX1;\n\tend\n\t\n\tSET_DELAY_GMAX1:\n\tbegin\n\t\tNEXT_STATE = SET_DELAY_GMAX2;\n\tend\n\t\n\tSET_DELAY_GMAX2:\n\tbegin\n\t\tNEXT_STATE = SET_IF_GMAX;\n\tend\n\t\n\tSET_IF_GMAX:\n\tbegin\n\t\tNEXT_STATE = INCR_I_GMAX;\n\tend\n\t\n\tINCR_I_GMAX:\n\tbegin\n\t\tNEXT_STATE = CHECK_I_GMAX;\n\tend\n\t\n\tSTART_PPSM:\n\tbegin\n\t\tif(doneppsm)\n\t\tbegin\n\t\t\tNEXT_STATE = GET_BESTF0;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = START_PPSM;\n\t\tend\n\tend\n\t\n\tGET_BESTF0:\n\tbegin\n\t\tNEXT_STATE = INIT_FOR_SQ;\n\tend\n\t\n\tINIT_FOR_SQ:\n\tbegin\n\t\tNEXT_STATE = CHECK_FOR_SQ;\n\tend\n\t\n\tCHECK_FOR_SQ:\n\tbegin\n\t\tif(i < 10'd240)\n\t\tbegin\n\t\t\tNEXT_STATE = SET_ADDR_FOR_SQ;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = START_DIV_BEST0;\n\t\tend\n\t\t\n\tend\n\t\n\tSET_ADDR_FOR_SQ:\n\tbegin\n\t\tNEXT_STATE = FOR_SQ_DELAY1;\n\tend\n\t\n\tFOR_SQ_DELAY1:\n\tbegin\n\t\tNEXT_STATE = FOR_SQ_DELAY2;\n\tend\n\t\n\tFOR_SQ_DELAY2:\n\tbegin\n\t\tNEXT_STATE = GET_SQ_I_N;\n\tend\n\t\n\tGET_SQ_I_N:\n\tbegin\n\t\tNEXT_STATE = SET_SQ_I_N;\n\tend\n\t\n\tSET_SQ_I_N:\n\tbegin\n\t\tNEXT_STATE = INCR_SQ_I;\n\tend\n\t\n\tINCR_SQ_I:\n\tbegin\n\t\tNEXT_STATE = CHECK_FOR_SQ;\n\tend\n\t\n\tSTART_DIV_BEST0:\n\tbegin\n\t\tNEXT_STATE = CALC_DIV_BESTF0;\n\tend\n\t\n\tCALC_DIV_BESTF0:\n\tbegin\n\t\tif(donediv)\n\t\tbegin\n\t\t\tNEXT_STATE = SET_PITCH;\n\t\tend\n\t\telse\n\t\tbegin\n\t\t\tNEXT_STATE = CALC_DIV_BESTF0;\n\t\tend\n\tend\n\t\n\tSET_PITCH:\n\tbegin\n\t\tNEXT_STATE = DONE;\n\tend\n\n\tDONE:\n\tbegin\n\t\tNEXT_STATE = START;\n\tend\n\n\tdefault:\n\tbegin\n\t\tNEXT_STATE = DONE;\n\tend\n\n\tendcase\nend\n\n\nalways@(posedge clk or negedge rst)     \nbegin\n\n\tif (rst == 1'b0)\n\tbegin\n\n\t\tdonenlp <= 1'b0;\n\n\tend\n\n\telse\n\tbegin\n\t\tcase(STATE)\n\n\t\tSTART:\n\t\tbegin\n\t\t\tdonenlp <= 1'b0;\n\t\tend\n\n\t\tINIT_FOR_1:\n\t\tbegin\n\t\t\ti <= M - N_SAMP;\n\t\t\twrite_sq <= 1'b1;\n\t\t\tread_sq <= 1'b0;\n\t\tend\n\n\t\tCHECK_I:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tREAD_SN:\n\t\tbegin\n\t\t\taddr_sn <= i;\n\t\tend\n\n\t\tSET_DELAY_1:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_DELAY_2:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tCALC_SN_SQ:\n\t\tbegin\n\t\t\tm1_in1 <= out_sn;\n\t\t\tm1_in2 <= out_sn;\n\t\t\taddr_nlp_sq <= i;\n\t\tend\n\n\t\tSET_NLP_SQ:\n\t\tbegin\n\t\t\tin_sq <= m1_out;\n\t\t\n\t\tend\n\n\t\tINCR_I:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\t\t\n\t\tINIT_FOR_2:\n\t\tbegin\n\t\t\ti <= M - N_SAMP;\n\t\t\tmem_x <= nlp_mem_x;\n\t\t\tmem_y <= nlp_mem_y;\n\t\tend\n\n\t\tCHECK_I_2:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_ADDR_SQ_2:\n\t\tbegin\n\t\t\taddr_nlp_sq <= i;\n\t\t\tread_sq <= 1'b1;\n\t\t\twrite_sq <= 1'b0;\n\t\tend\n\n\t\tSET_DELAY_3:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_DELAY_4:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tNOTCH_1:\n\t\tbegin\n\t\t\ta1_in1 <= out_sq;\n\t\t\ta1_in2 <= {(mem_x[N-1] == 0)?1'b1:1'b0,mem_x[N-2:0]};\n\t\tend\n\n\t\tNOTCH_2:\n\t\tbegin\n\t\t\tm1_in1 <= COEFF;\n\t\t\tm1_in2 <= mem_y;\n\t\t\tnotch <= a1_out;\n\t\t\n\t\tend\n\n\t\tSET_MEM_X:\n\t\tbegin\n\t\t\ta1_in1 <= notch;\n\t\t\ta1_in2 <= m1_out;\n\t\t\tmem_x <= out_sq;\n\t\t\twrite_sq <= 1'b1;\n\t\t\tread_sq <= 1'b0;\n\t\tend\n\n\t\tSET_MEM_Y:\n\t\tbegin\n\t\t\tmem_y <= a1_out;\n\t\t\tnotch <= a1_out;\n\t\t\n\t\tend\n\n\t\tSET_NEW_SQ_1:\n\t\tbegin\n\t\t\ta1_in1 <= notch;\n\t\t\ta1_in2 <= ONE;\n\t\tend\n\n\t\tSET_NEW_SQ_2:\n\t\tbegin\n\t\t\tin_sq <= a1_out;\n\t\t\t\n\t\tend\n\n\t\tINCR_I_2:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\t\t\n\t\tINIT_FOR_3:\n\t\tbegin\n\t\t\ti <= M - N_SAMP;\n\t\tend\n\n\t\tCHECK_I_3:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tINNER_FOR_1:\n\t\tbegin\n\t\t\tj <= 10'd0;\n\t\tend\n\n\t\tCHECK_J:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_ADDR_FIR:\n\t\tbegin\n\t\t\taddr_mem_fir <= j + 10'd1;\n\t\t\tread_fir <= 1'b1;\n\t\t\twrite_fir <= 1'b0;\n\t\tend\n\n\t\tSET_DELAY_5:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_DELAY_6:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tGET_FIR_1:\n\t\tbegin\n\t\t\tmem_fir_j_1 <= out_mem_fir;\n\t\tend\n\n\t\tADDR_WRITE_FIR:\n\t\tbegin\n\t\t\taddr_mem_fir <= j;\n\t\t\tread_fir <= 1'b0;\n\t\t\twrite_fir <= 1'b1;\n\t\tend\n\n\t\tGET_FIR_2:\n\t\tbegin\n\t\t\tin_mem_fir <= mem_fir_j_1;\n\t\tend\n\n\t\tINCR_J:\n\t\tbegin\n\t\t\tj <= j + 10'd1;\n\t\tend\n\n\t\tADDR_LAST_FIR:\n\t\tbegin\n\t\t\taddr_mem_fir <= 10'd47;\n\t\t\tread_fir <= 1'b0;\n\t\t\twrite_fir <= 1'b1;\n\t\t\taddr_nlp_sq <= i;\n\t\t\tread_sq <= 1'b1;\n\t\t\twrite_sq <= 1'b0;\n\t\tend\n\n\t\tSET_DELAY_7:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_DELAY_8:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_LAST_FIR:\n\t\tbegin\n\t\t\tin_mem_fir <= out_sq;\n\t\t\twrite_sq <= 1'b1;\n\t\t\tread_sq <= 1'b0;\n\t\tend\n\t\t\n\t\tSET_SQ_0:\n\t\tbegin\n\t\t\tin_sq <= 32'b0;\n\t\tend\n\n\t\tINNER_FOR_2:\n\t\tbegin\n\t\t\tj <= 10'd0;\n\t\tend\n\n\t\tCHECK_J_2:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tREAD_FIR1:\n\t\tbegin\n\t\t\taddr_mem_fir <= j;\n\t\t\tread_fir <= 1'b1;\n\t\t\twrite_fir <= 1'b0;\n\t\tend\n\n\t\tSET_DELAY_9:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_DELAY_10:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tMULT_NLP_FIR:\n\t\tbegin\n\t\t\tcase (j)\n\t\t\t10'd0  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir0;\n\t\t\t   end\n\t\t\t10'd1  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir1;\n\t\t\t   end\n\t\t\t10'd2  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir2;\n\t\t\t   end\n\t\t\t10'd3  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir3;\n\t\t\t   end\n\t\t\t10'd4  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir4;\n\t\t\t   end\n\t\t\t10'd5  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir5;\n\t\t\t   end\n\t\t\t10'd6  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir6;\n\t\t\t   end\n\t\t\t10'd7  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir7;\n\t\t\t   end\n\t\t\t10'd8  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir8;\n\t\t\t   end\n\t\t\t10'd9  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir9;\n\t\t\t   end\n\t\t\t10'd10  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir10;\n\t\t\t   end\n\t\t\t10'd11  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir11;\n\t\t\t   end\n\t\t\t10'd12  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir12;\n\t\t\t   end\n\t\t\t10'd13  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir13;\n\t\t\t   end\n\t\t\t10'd14  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir14;\n\t\t\t   end\n\t\t\t10'd15  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir15;\n\t\t\t   end\n\t\t\t10'd16  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir16;\n\t\t\t   end\n\t\t\t10'd17  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir17;\n\t\t\t   end\n\t\t\t10'd18  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir18;\n\t\t\t   end\n\t\t\t10'd19  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir19;\n\t\t\t   end\n\t\t\t10'd20  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir20;\n\t\t\t   end\n\t\t\t10'd21  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir21;\n\t\t\t   end\n\t\t\t10'd22  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir22;\n\t\t\t   end\n\t\t\t10'd23  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir23;\n\t\t\t   end\n\t\t\t10'd24  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir24;\n\t\t\t   end\n\t\t\t10'd25  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir25;\n\t\t\t   end\n\t\t\t10'd26  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir26;\n\t\t\t   end\n\t\t\t10'd27  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir27;\n\t\t\t   end\n\t\t\t10'd28  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir28;\n\t\t\t   end\n\t\t\t10'd29  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir29;\n\t\t\t   end\n\t\t\t10'd30  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir30;\n\t\t\t   end\n\t\t\t10'd31  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir31;\n\t\t\t   end\n\t\t\t10'd32  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir32;\n\t\t\t   end\n\t\t\t10'd33  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir33;\n\t\t\t   end\n\t\t\t10'd34  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir34;\n\t\t\t   end\n\t\t\t10'd35  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir35;\n\t\t\t   end\n\t\t\t10'd36  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir36;\n\t\t\t   end\n\t\t\t10'd37  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir37;\n\t\t\t   end\n\t\t\t10'd38  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir38;\n\t\t\t   end\n\t\t\t10'd39  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir39;\n\t\t\t   end\n\t\t\t10'd40  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir40;\n\t\t\t   end\n\t\t\t10'd41  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir41;\n\t\t\t   end\n\t\t\t10'd42  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir42;\n\t\t\t   end\n\t\t\t10'd43  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir43;\n\t\t\t   end\n\t\t\t10'd44  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir44;\n\t\t\t   end\n\t\t\t10'd45  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir45;\n\t\t\t   end\n\t\t\t10'd46  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir46;\n\t\t\t   end\n\t\t\t10'd47  :\n\t\t\t   begin\n\t\t\t\t   m1_in1 <= out_mem_fir;\n\t\t\t\t   m1_in2 <= nlp_fir47;\n\t\t\t   end\n\t\t\t\n\t\t\tendcase\n\t\t\twrite_sq <= 1'b0;\n\t\t\tread_sq <= 1'b1;\n\t\t\t\n\t\tend\n\t\t\n\t\tSET_DELAY_11:\n\t\tbegin\n\t\t\n\t\tend\n\t\t\n\t\tSET_DELAY_12:\n\t\tbegin\n\t\t\n\t\tend\n\n\t\tADDR_FIR_SQ:\n\t\tbegin\n\t\t\ta1_in1 <= m1_out;\n\t\t\ta1_in2 <= out_sq;\n\t\t\twrite_sq <= 1'b1;\n\t\t\tread_sq <= 1'b0;\n\t\tend\n\n\t\tSET_SQ_FIR:\n\t\tbegin\n\t\t\tin_sq <= a1_out;\n\t\t\t\n\t\tend\n\n\t\tINCR_J_2:\n\t\tbegin\n\t\t\tj <= j + 10'd1;\n\t\tend\n\n\t\tINCR_I3:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\t\t\n\t\tFFT_INIT:\n\t\tbegin\n\t\t\ti <= 10'd0;\n\t\tend\n\n\t\tFFT_ADDR:\n\t\tbegin\n\t\t\taddr_in_real <= i;\n\t\t\taddr_in_imag <= i;\n\t\t\tre_fftr <= 1'b0;\n\t\t\tre_ffti <= 1'b0;\n\t\t\twe_fftr <= 1'b1;\n\t\t\twe_ffti <= 1'b1;\n\t\t\t\n\t\tend\n\n\t\tDELAY_FFT_1:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tDELAY_FFT_2:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tWRITE_FFT_INIT:\n\t\tbegin\n\t\t\twrite_in_fft_real <= 32'b0;\n\t\t\twrite_in_fft_imag <= 32'b0;\n\t\tend\n\n\t\tINCR_I4:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\n\t\tCHECK_I4:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tINIT_FOR_4:\n\t\tbegin\n\t\t\ti <= 10'd0;\n\t\tend\n\n\t\tCHECK_I5:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tCALC_FFT_ADDR:\n\t\tbegin\n\t\t\taddr_nlp_sq <= i * DEC;\n\t\t\tread_sq <= 1'b1;\n\t\t\twrite_sq <= 1'b0;\n\t\t\t\n\t\t\t\n\t\t\taddr_in_real <= i;\n\t\t\tre_fftr <= 1'b0;\n\t\t\twe_fftr <= 1'b1;\n\t\t\t\n\t\t\t\n\t\tend\n\n\t\tFOR_DELAY_1:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tFOR_DELAY_2:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tCALC_FFT_SQ_W:\n\t\tbegin\n\t\t\tm1_in1 <= out_sq;\n\t\t\tcase (i)\n\t\t\t\t10'd0  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w0;\n\t\t\t\t   end\n\t\t\t\t10'd1  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w1;\n\t\t\t\t   end\n\t\t\t\t10'd2  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w2;\n\t\t\t\t   end\n\t\t\t\t10'd3  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w3;\n\t\t\t\t   end\n\t\t\t\t10'd4  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w4;\n\t\t\t\t   end\n\t\t\t\t10'd5  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w5;\n\t\t\t\t   end\n\t\t\t\t10'd6  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w6;\n\t\t\t\t   end\n\t\t\t\t10'd7  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w7;\n\t\t\t\t   end\n\t\t\t\t10'd8  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w8;\n\t\t\t\t   end\n\t\t\t\t10'd9  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w9;\n\t\t\t\t   end\n\t\t\t\t10'd10  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w10;\n\t\t\t\t   end\n\t\t\t\t10'd11  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w11;\n\t\t\t\t   end\n\t\t\t\t10'd12  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w12;\n\t\t\t\t   end\n\t\t\t\t10'd13  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w13;\n\t\t\t\t   end\n\t\t\t\t10'd14  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w14;\n\t\t\t\t   end\n\t\t\t\t10'd15  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w15;\n\t\t\t\t   end\n\t\t\t\t10'd16  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w16;\n\t\t\t\t   end\n\t\t\t\t10'd17  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w17;\n\t\t\t\t   end\n\t\t\t\t10'd18  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w18;\n\t\t\t\t   end\n\t\t\t\t10'd19  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w19;\n\t\t\t\t   end\n\t\t\t\t10'd20  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w20;\n\t\t\t\t   end\n\t\t\t\t10'd21  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w21;\n\t\t\t\t   end\n\t\t\t\t10'd22  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w22;\n\t\t\t\t   end\n\t\t\t\t10'd23  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w23;\n\t\t\t\t   end\n\t\t\t\t10'd24  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w24;\n\t\t\t\t   end\n\t\t\t\t10'd25  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w25;\n\t\t\t\t   end\n\t\t\t\t10'd26  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w26;\n\t\t\t\t   end\n\t\t\t\t10'd27  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w27;\n\t\t\t\t   end\n\t\t\t\t10'd28  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w28;\n\t\t\t\t   end\n\t\t\t\t10'd29  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w29;\n\t\t\t\t   end\n\t\t\t\t10'd30  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w30;\n\t\t\t\t   end\n\t\t\t\t10'd31  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w31;\n\t\t\t\t   end\n\t\t\t\t10'd32  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w32;\n\t\t\t\t   end\n\t\t\t\t10'd33  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w33;\n\t\t\t\t   end\n\t\t\t\t10'd34  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w34;\n\t\t\t\t   end\n\t\t\t\t10'd35  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w35;\n\t\t\t\t   end\n\t\t\t\t10'd36  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w36;\n\t\t\t\t   end\n\t\t\t\t10'd37  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w37;\n\t\t\t\t   end\n\t\t\t\t10'd38  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w38;\n\t\t\t\t   end\n\t\t\t\t10'd39  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w39;\n\t\t\t\t   end\n\t\t\t\t10'd40  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w40;\n\t\t\t\t   end\n\t\t\t\t10'd41  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w41;\n\t\t\t\t   end\n\t\t\t\t10'd42  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w42;\n\t\t\t\t   end\n\t\t\t\t10'd43  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w43;\n\t\t\t\t   end\n\t\t\t\t10'd44  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w44;\n\t\t\t\t   end\n\t\t\t\t10'd45  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w45;\n\t\t\t\t   end\n\t\t\t\t10'd46  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w46;\n\t\t\t\t   end\n\t\t\t\t10'd47  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w47;\n\t\t\t\t   end\n\t\t\t\t10'd48  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w48;\n\t\t\t\t   end\n\t\t\t\t10'd49  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w49;\n\t\t\t\t   end\n\t\t\t\t10'd50  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w50;\n\t\t\t\t   end\n\t\t\t\t10'd51  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w51;\n\t\t\t\t   end\n\t\t\t\t10'd52  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w52;\n\t\t\t\t   end\n\t\t\t\t10'd53  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w53;\n\t\t\t\t   end\n\t\t\t\t10'd54  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w54;\n\t\t\t\t   end\n\t\t\t\t10'd55  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w55;\n\t\t\t\t   end\n\t\t\t\t10'd56  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w56;\n\t\t\t\t   end\n\t\t\t\t10'd57  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w57;\n\t\t\t\t   end\n\t\t\t\t10'd58  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w58;\n\t\t\t\t   end\n\t\t\t\t10'd59  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w59;\n\t\t\t\t   end\n\t\t\t\t10'd60  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w60;\n\t\t\t\t   end\n\t\t\t\t10'd61  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w61;\n\t\t\t\t   end\n\t\t\t\t10'd62  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w62;\n\t\t\t\t   end\n\t\t\t\t10'd63  :\n\t\t\t\t   begin\n\t\t\t\t\t   m1_in2 <= nlp_w63;\n\t\t\t\t   end\n\t\t\tendcase\n\t\tend\n\n\t\tWRITE_FFT_REAL:\n\t\tbegin\n\t\t\twrite_in_fft_real <= m1_out;\n\t\t\tif(i == 10'd61)\n\t\t\tbegin\n\t\t\t\t\n\t\t\tend\n\t\t\t\n\t\tend\n\n\t\tINCR_I_5:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\t\t\n\t\t\t\n\t\tSTART_DFT:\n\t\tbegin\n\t\t\tstartfft <= 1'b1;\n\t\t\t\n\t\t\tre_fftr <= 1'b1;\n\t\t\twe_fftr <= 1'b0;\n\t\t\tre_ffti <= 1'b1;\n\t\t\twe_ffti <= 1'b0;\n\t\t\t\n\t\t\tre_out_fftr <= 1'b0;\n\t\t\twe_out_fftr <= 1'b1;\n\t\t\tre_out_ffti <= 1'b0;\n\t\t\twe_out_ffti <= 1'b1;\n\t\t\t\n\t\tend\n\t\t\n\t\tRUN_DFT:\n\t\tbegin\n\t\t\tstartfft <= 1'b0;\n\t\t\taddr_in_real <= fft_addr_in_real;\n\t\t\taddr_in_imag <= fft_addr_in_imag;\n\t\t\t\n\t\t\taddr_out_real <= fft_addr_out_real;\n\t\t\taddr_out_imag <= fft_addr_out_imag;\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\twrite_fft_real <= fft_write_fft_real;\n\t\t\twrite_fft_imag <= fft_write_fft_imag;\n\t\tend\n\t\t\n\t\tINIT_FOR_5:\n\t\tbegin\n\t\t\ti <= 10'd0;\n\t\tend\n\n\t\tCHECK_I_6:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tSET_ADDR_FOR_5:\n\t\tbegin\n\t\t\taddr_out_real <= i;\n\t\t\taddr_out_imag <= i;\n\t\t\tre_out_fftr <= 1'b1;\n\t\t\twe_out_fftr <= 1'b0;\n\t\t\tre_out_ffti <= 1'b1;\n\t\t\twe_out_ffti <= 1'b0; \n\t\tend\n\n\t\tFOR_5_DELAY1:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tFOR_5_DELAY2:\n\t\tbegin\n\t\t\t\n\t\tend\n\n\t\tMULT_REAL_IMAGE_SQ:\n\t\tbegin\n\t\t\t\n\n\n\n\n\t\t\t\n\t\t\tm1 <= {17'b0,out_fft_real[N-2:16]};\n\t\t\tm2 <= {17'b0,out_fft_real[N-2:16]};\n\t\t\tm3 <= {17'b0,out_fft_imag[N-2:16]};\n\t\t\tm4 <= {17'b0,out_fft_imag[N-2:16]};\n\t\t\t\n\t\tend\n\n\t\tADD_REAL_IMAG_SQ:\n\t\tbegin\n\t\t\t\n\n\t\t\t\n\t\t\ta1 <= m1 * m2;\n\t\t\ta2 <= m3 * m4;\n\t\t\t\n\t\t\twe_out_fftr_gmax <= 1'b1;\n\t\t\tre_out_fftr_gmax <= 1'b0;\n\t\t\taddr_out_real_gmax <= i;\n\t\t\t\n\t\t\n\t\t\t\n\t\t\t\n\t\tend\n\n\t\tSET_FW_REAL_ADD:\n\t\tbegin\n\t\t\twrite_fft_real_gmax <= a1 + a2;;\n\t\t\t\n\t\tend\n\n\t\tINCR_I6:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend \n\t\t\n\t\tSET_GMAX_GMAX_BIN:\n\t\tbegin\n\t\t\tgmax = 32'b0;\n\t\t\tgmax_bin <= 10'd16;\n\t\tend\n\t\t\n\t\tINIT_FOR_GMAX:\n\t\tbegin\n\t\t\ti <= 10'd16; \n\t\tend\n\t\t\n\t\tCHECK_I_GMAX:\n\t\tbegin\n\t\t\t\n\t\tend\n\t\t\n\t\tSET_ADDR_FW_GMAX:\n\t\tbegin\n\t\t\taddr_out_real_gmax <= i;\n\t\t\tre_out_fftr_gmax <= 1'b1;\n\t\t\twe_out_fftr_gmax <= 1'b0;\n\t\tend\n\t\t\n\t\tSET_DELAY_GMAX1:\n\t\tbegin\n\t\t\n\t\tend\n\t\t\n\t\tSET_DELAY_GMAX2:\n\t\tbegin\n\t\t\n\t\tend\n\t\t\n\t\tSET_IF_GMAX:\n\t\tbegin\n\t\t\tif(out_fft_real_gmax > gmax)\n\t\t\tbegin\n\t\t\t\tgmax <= out_fft_real_gmax;\n\t\t\t\tgmax_bin <= i;\n\t\t\tend\n\t\tend\n\t\t\n\t\tINCR_I_GMAX:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\t\t\n\t\tSTART_PPSM:\n\t\tbegin\n\t\t\tstartppsm <= 1'b1;\n\t\t\tout_fw_real <= out_fft_real_gmax;\n\t\t\tpp_gmax <= gmax;\n\t\t\tpp_gmax_bin <= gmax_bin;\n\t\t\tpp_prev_f0 <= {16'd50,16'd0};\n\t\t\taddr_out_real_gmax <= addr_fw_real;\n\t\tend\n\t\t\n\t\tGET_BESTF0:\n\t\tbegin\n\t\t\tbest_f0 <= pp_best_f0;\n\t\tend\n\t\t\n\t\t\n\t\t\t\n\n\t\t\n\t\tINIT_FOR_SQ:\n\t\tbegin\n\t\t\ti <= 10'd0;\n\t\tend\n\t\t\n\t\tCHECK_FOR_SQ:\n\t\tbegin\n\t\t\t\n\t\tend\n\t\t\n\t\tSET_ADDR_FOR_SQ:\n\t\tbegin\n\t\t\taddr_nlp_sq <= i + 10'd80;\n\t\t\tread_sq <= 1'b1;\n\t\t\twrite_sq <= 1'b0;\n\t\tend\n\t\t\n\t\tFOR_SQ_DELAY1:\n\t\tbegin\n\t\t\n\t\tend\n\t\t\n\t\tFOR_SQ_DELAY2:\n\t\tbegin\n\t\t\n\t\tend\n\t\t\n\t\tGET_SQ_I_N:\n\t\tbegin\n\t\t\tout_sq_i_n <= out_sq;\n\t\t\taddr_nlp_sq <= i;\n\t\t\tread_sq <= 1'b0;\n\t\t\twrite_sq <= 1'b1;\n\t\tend\n\t\t\n\t\tSET_SQ_I_N:\n\t\tbegin\n\t\t\tin_sq <= out_sq_i_n;\n\t\tend\n\t\t\n\t\tINCR_SQ_I:\n\t\tbegin\n\t\t\ti <= i + 10'd1;\n\t\tend\n\t\t\n\t\tSTART_DIV_BEST0:\n\t\tbegin\n\t\t\tstartdiv <= 1'b1;\n\t\t\tdiv_in <= best_f0;\n\t\tend\n\t\t\n\t\tCALC_DIV_BESTF0:\n\t\tbegin\n\t\t\tm1_in1 <= div_ans;\n\t\t\tm1_in2 <= NLP_FS;\n\t\t\tstartdiv <= 1'b0; \n\t\tend\n\t\t\n\t\tSET_PITCH:\n\t\tbegin\n\t\t\tpitch <= m1_out;\n\t\t\tnlp_mem_x_out <= mem_x;\n\t\t\tnlp_mem_y_out <= mem_y;\t\n\t\t\tout_prev_f0 <= best_f0;\n\t\tend\n\t\t\n\t\tDONE:\n\t\tbegin\n\t\t\tdonenlp <= 1'b1;\n\t\tend\n\n\t\tendcase\n\tend\n\nend\n\n\nendmodule</code>"
                },
                {
                    "type": "text",
                    "text": "Based on the provided original Verilog code, its comments and above answers, generate a detailed specification for the module. Include the following information in a single, concise paragraph:\n1. The name of the module.\n2. A simple explanation of the module's functionality.\n3. The input and output ports, along with a brief explanation of each.\n4. The internal signals used within the module, with a brief explanation of their purpose.\n5. An overview of the different blocks or sections in the code and their functions.\nEnsure that the specification is clear and accurately reflects the details from the code and comments.\nYour answer should be structured and well-organized, providing a comprehensive and detailed overview of the module's design and operation.\nPlease provide your answer in the following format:\nModule name: [module name]. Module specification: [module specification]."
                },
                {
                    "type": "text",
                    "text": "Module name: nlp_test. Module specification: The nlp_test module implements a Non-Linear Pitch (NLP) estimation algorithm for speech processing. It performs notch filtering, FIR filtering, FFT computation, and post-processing to estimate the pitch of an input signal. The module has input ports for initiating the algorithm (startnlp), clock (clk), reset (rst), initial memory values (nlp_mem_x, nlp_mem_y), and previous fundamental frequency (prev_f0). Output ports include the best estimated fundamental frequency (best_f0), previous fundamental frequency (out_prev_f0), completion indicator (donenlp), estimated pitch (pitch), and updated memory values (nlp_mem_x_out, nlp_mem_y_out). Internally, it uses various signals for state management, memory addressing, arithmetic operations, and control flags. The module is structure"
                }
            ]
        }
    ]
}