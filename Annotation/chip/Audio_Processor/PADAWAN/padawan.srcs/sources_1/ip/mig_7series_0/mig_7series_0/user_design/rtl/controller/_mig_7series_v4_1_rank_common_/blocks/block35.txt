Line number: 
[329, 346]
Comment: 
This block of Verilog RTL code manages the state of a DDR memory controller's maintenance operations. The state machine's next state (maint_rank_ns) is updated based on various conditions. If there's a reset (rst), maint_rank_ns is set to 0. Otherwise, it assumes the value of maint_rank_r_lcl - the present state. If any of the maintenance operations such as ZQ Calibration (maint_zq_ns), Self-Refresh Entry (maint_sre_ns) or Self-Refresh Exit (maint_srx_ns) are requested, maint_rank_ns increments by 1. However, if the rank represented by maint_rank_ns is not present, it continues incrementing by 1 till it finds a present rank. Alternatively, if there's an update from the last master pulse (upd_last_master_pls), maint_rank_ns is set to the rank of the current maintenance grant (maint_grant_r[i]).