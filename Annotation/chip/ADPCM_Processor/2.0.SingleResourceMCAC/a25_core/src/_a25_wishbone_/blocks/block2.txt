Line number: 
[212, 261]
Comment: 
The block of code serves the purpose of a synchronous reset and defines the operation of a write buffer for a Wishbone bus protocol. When a reset or clock edge event occurs, all output ports and the serving port are reset to default. In the absence of a reset event, whenever a new access is initiated, it checks for data validity in three write buffers. If data is found valid, appropriate signals for writing are enabled, write address, write data and byte enables are fetched from the respective valid buffer, and the Wishbone cycle and strobe signals are set 'on'. Additionally, the serving port is designated as per the selected valid buffer (buffer 0, 1, or 2) with 3-bit serving port codes. If no valid data is found in those buffers, the write enable, cycle and strobe signals are set to 'off', write addresses and data are zeroed and the serving port is set to 'idle' state.