Line number: 
[239, 293]
Comment: 
This block of code controls a state machine. For each state (READY, DECIDE, ADDR_PHASE, etc.), the code sets variables and defines the path to the next state based on certain conditions. In the READY state, it enters into DECIDE state if the command is valid. Then, in the DECIDE state, the load_shift_n and addr_data_sel_n are set to 1 and transition to the ADDR_PHASE is setup. The ADDR_PHASE state routes to different states based on various conditional checks on bit_cnt, rd_not_write_reg, and AddressPhase. There are intermediate ADDR_TO_DATA_GAP states to handle the loading of shift register before moving to the DATA_PHASE. Finally, after the DATA_PHASE it prepares to return to the READY state via ALMOST_READY.